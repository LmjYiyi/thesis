---
description: 论文图像调整工作流程 - 基于上下文理解的MATLAB绘图代码修改
---

# 论文图像调整 Workflow

## 适用场景

当需要修改 `final_output/figure_code/` 下的论文图像代码时使用本工作流。

**典型场景**：
- 调整图表的视觉效果（颜色、字体、线宽等）
- 修正图表中的物理参数
- 根据导师/审稿人意见调整图表内容
- 优化图表的可读性和学术规范性
- 修复图表中的错误或不一致

---

## ⚠️ 核心原则：上下文优先

**直接修改代码是错误的做法！**

修改任何图像代码之前，**必须**先理解以下上下文：
1. **对应的定稿文档**：图表在论文中的物理意义和描述
2. **核心研究档案**：确保修改符合理论基础
3. **现有代码逻辑**：理解当前实现的设计意图

---

## 资源文件路径

### 图像代码目录
```
final_output/figure_code/
├── plot_fig_3_2_*.m        # 第3.2节图表
├── plot_fig_3_3_*.m        # 第3.3节图表
├── plot_fig_3_4_*.m        # 第3.4节图表
├── plot_fig_4_*.m          # 第4章图表
├── plot_fig_5_*.m          # 第5章图表
└── ...
```

### 定稿文档目录
```
final_output/
├── 第3章_3.1_*_final.md    # 对应章节定稿
├── 第3章_3.3_*_final.md
├── 第4章_4.1_*_final.md
├── ...
└── figures/                 # 生成的图片输出目录
```

### 核心参考资源
- [核心研究档案](../../resources/核心研究档案.txt) - 理论基础
- [论文大纲](../../resources/大纲.txt) - 章节结构
- [仿真代码](../../thesis-code/) - 原始仿真逻辑参考

---

## 图像代码文件命名规范

```
plot_fig_{章节}_{序号}_{简短描述}.m
```

**示例**：
- `plot_fig_3_2_time_frequency_spectrogram.m` → 图3-2 时频谱图
- `plot_fig_4_3_posterior_comparison.m` → 图4-3 后验对比
- `plot_fig_5_7_to_5_12_butterworth.m` → 图5-7至5-12 Butterworth相关

---

## 修改流程（四步法）

### Step 1: 确定图表上下文

在修改任何代码之前，**必须**完成以下检查：

```
┌─────────────────────────────────────────────────────────────┐
│  1.1 识别图表所属章节                                         │
│  从文件名推断：plot_fig_3_2_xxx.m → 第3.2节                   │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│  1.2 阅读对应的定稿文档                                       │
│  final_output/第3章_3.2_*_final.md                          │
│  或最相关的章节定稿                                           │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│  1.3 提取图表在文中的描述                                     │
│  - 图表的物理意义                                            │
│  - 预期展示的现象                                            │
│  - 关键参数设置                                              │
│  - 与理论公式的对应关系                                       │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│  1.4 阅读现有代码                                            │
│  理解当前实现的设计意图和物理逻辑                              │
└─────────────────────────────────────────────────────────────┘
```

---

### Step 2: 分析修改需求

明确修改的类型和范围：

| 修改类型 | 描述 | 风险级别 | 需要验证的内容 |
|---------|------|---------|---------------|
| **视觉调整** | 颜色、字体、线宽、标注 | 低 | 学术规范性 |
| **布局调整** | 子图排列、坐标轴范围 | 低 | 可读性 |
| **参数修正** | 物理参数值修改 | 中 | 与定稿文档一致性 |
| **内容变更** | 增删曲线、修改物理逻辑 | 高 | 与理论一致性 |
| **结构重构** | 完全重写绘图逻辑 | 高 | 全面验证 |

---

### Step 3: 执行修改

根据修改类型选择对应策略：

#### 3A. 视觉调整（低风险）

直接修改相关代码，无需深度验证：

```matlab
% 典型视觉调整项
set(gca, 'FontSize', 12);           % 字体大小
set(gca, 'LineWidth', 1.5);         % 坐标轴线宽
plot(x, y, 'LineWidth', 2.0);       % 曲线线宽
colormap(parula);                   % 配色方案
xlabel('频率 (GHz)', 'FontWeight', 'bold');  % 坐标轴标签
```

---

#### 3B. 参数修正（中风险）

**必须**对照定稿文档验证：

```markdown
【修改前检查清单】
- [ ] 确认定稿文档中对该参数的描述
- [ ] 确认核心研究档案中的理论值
- [ ] 确认与其他相关图表的一致性
```

**示例**：修改等离子体频率 $f_p$

```matlab
% 修改前：核对定稿文档
% 文档中写道："在强色散区（f_p=29 GHz）"

% 修改代码
fp_strong = 29e9;   % 必须与定稿一致
```

---

#### 3C. 内容变更（高风险）

需要完整的上下文理解和验证流程：

```markdown
【内容变更流程】
1. 阅读完整的定稿文档章节
2. 理解图表的物理目的
3. 确认变更不违背理论基础
4. 修改代码
5. 验证输出是否符合预期
6. 更新代码注释说明变更原因
```

---

### Step 4: 验证与文档

修改完成后，执行以下验证：

```markdown
【验证检查清单】
- [ ] 代码可独立运行，无错误
- [ ] 输出图表符合定稿文档描述
- [ ] 物理参数与定稿一致
- [ ] 视觉效果符合学术规范
- [ ] 代码注释已更新
- [ ] 图片已正确保存到 final_output/figures/
```

---

## 图表代码标准结构

所有绘图代码应遵循以下结构：

```matlab
%% plot_fig_X_X_描述.m
% 论文图 X-X：[图表标题]
% 生成日期：YYYY-MM-DD
% 对应章节：X.X.X [章节名称]
%
% 图表核心表达：
% - [要展示的物理现象1]
% - [要展示的物理现象2]
% - [关键对比/结论]

clear; clc; close all;

%% 1. 物理常数与参数设置
% 【必须与定稿文档保持一致】
c = 2.99792458e8;           % 光速 (m/s)
% ... 其他物理常数

% 等离子体/系统参数
f_p = 29e9;                 % 等离子体频率 (Hz) ← 对应文档描述
% ... 其他参数

%% 2. 物理计算
% 【计算逻辑与理论公式对应】
% ... 计算代码

%% 3. 数据准备
% 【为绘图准备数据】
% ... 数据处理

%% 4. 高质量学术绘图
% 【遵循绘图规范】
figure('Position', [100, 100, 800, 600], 'Color', 'w');

% 设置中文字体
set(0, 'DefaultAxesFontName', 'SimHei');
set(0, 'DefaultTextFontName', 'SimHei');

% 绘图代码
% ...

% 标准设置
set(gca, 'FontSize', 11, 'LineWidth', 1.2, 'Box', 'on');
grid on;

%% 5. 保存图表
output_dir = fullfile(fileparts(mfilename('fullpath')), '..', 'figures');
if ~exist(output_dir, 'dir')
    mkdir(output_dir);
end

% 保存多格式
print('-dpng', '-r300', fullfile(output_dir, '图X-X_标题.png'));
print('-dsvg', fullfile(output_dir, '图X-X_标题.svg'));

fprintf('✓ 图 X-X 已保存至 final_output/figures/\n');
```

---

## 绘图风格规范

### 标准配色方案

```matlab
% 论文统一配色
colors = [
    0.0000, 0.4470, 0.7410;  % 蓝色 - 主曲线
    0.8500, 0.3250, 0.0980;  % 橙色 - 对比曲线
    0.9290, 0.6940, 0.1250;  % 黄色 - 辅助曲线
    0.4940, 0.1840, 0.5560;  % 紫色 - 特殊标注
    0.4660, 0.6740, 0.1880;  % 绿色 - 验证数据
];
```

### 字体与线宽

```matlab
% 字体设置
set(gca, 'FontName', 'Times New Roman', 'FontSize', 11);  % 英文
set(0, 'DefaultAxesFontName', 'SimHei');                   % 中文

% 线宽设置
line_width_main = 2.0;      % 主曲线
line_width_secondary = 1.5; % 次要曲线
line_width_axis = 1.2;      % 坐标轴
```

### 图片输出规范

| 格式 | 用途 | 设置 |
|-----|-----|-----|
| PNG | 预览、Word插入 | 300 DPI |
| SVG | LaTeX排版、矢量编辑 | 矢量 |
| PDF | 论文投稿 | 矢量 |
| TIF | 期刊要求 | 300-600 DPI |

```matlab
% 多格式输出
print('-dpng', '-r300', fullfile(output_dir, '图X-X.png'));
print('-dsvg', fullfile(output_dir, '图X-X.svg'));
print('-dpdf', '-vector', fullfile(output_dir, '图X-X.pdf'));
```

---

## 使用命令格式

### 模式A：快速视觉调整

```
请调整图表 [图号] 的视觉效果：

【图表文件】
- final_output/figure_code/plot_fig_X_X_xxx.m

【调整需求】
- [具体的视觉调整，如字体大小、颜色等]

【无需验证】视觉调整，不涉及物理内容
```

**示例**：
```
请调整图表 3-2 的视觉效果：

【图表文件】
- final_output/figure_code/plot_fig_3_2_time_frequency_spectrogram.m

【调整需求】
- 增大坐标轴字体到14pt
- 修改配色为jet
- 增加子图间距
```

---

### 模式B：参数修正（需验证）

```
请修正图表 [图号] 的参数：

【图表文件】
- final_output/figure_code/plot_fig_X_X_xxx.m

【对应定稿】
- final_output/第X章_X.X_xxx_final.md

【修正内容】
- 参数名: 原值 → 新值
- 原因: [修正原因]

【请先验证定稿文档中的描述】
```

**示例**：
```
请修正图表 3-2 的参数：

【图表文件】
- final_output/figure_code/plot_fig_3_2_time_frequency_spectrogram.m

【对应定稿】
- final_output/第3章_3.3_色散效应对差频信号的调制机理与误差解析_final.md

【修正内容】
- 等离子体频率: 29 GHz → 30 GHz
- 原因: 导师要求与实验数据对齐

【请先验证定稿文档中的描述】
```

---

### 模式C：内容变更（完整流程）

```
请修改图表 [图号] 的内容：

【图表文件】
- final_output/figure_code/plot_fig_X_X_xxx.m

【对应定稿】
- final_output/第X章_X.X_xxx_final.md

【变更需求】
- [详细描述需要变更的内容]
- [期望达到的效果]

【请执行完整的上下文理解流程】
1. 阅读定稿文档
2. 理解图表物理意义
3. 确认变更合理性
4. 执行修改
5. 验证输出
```

**示例**：
```
请修改图表 3-2 的内容：

【图表文件】
- final_output/figure_code/plot_fig_3_2_time_frequency_spectrogram.m

【对应定稿】
- final_output/第3章_3.3_色散效应对差频信号的调制机理与误差解析_final.md

【变更需求】
- 增加一个中等色散条件的子图 (f_p = 25 GHz)
- 使三个子图形成渐进对比效果

【请执行完整的上下文理解流程】
```

---

### 模式D：批量调整

```
请批量调整以下图表的视觉风格：

【图表文件列表】
- plot_fig_3_2_xxx.m
- plot_fig_3_3_xxx.m
- plot_fig_3_4_xxx.m

【统一调整】
- 字体: Times New Roman 12pt
- 线宽: 2.0
- 配色: parula
- 输出格式: PNG + SVG
```

---

## 常见调整场景与解决方案

### 场景1：字体显示为方框

**问题**：中文字体在MATLAB中显示为方框

**解决方案**：
```matlab
% 在代码开头添加
set(0, 'DefaultAxesFontName', 'SimHei');
set(0, 'DefaultTextFontName', 'SimHei');

% 或使用系统字体
set(gca, 'FontName', 'Microsoft YaHei');
```

---

### 场景2：图片分辨率不足

**问题**：导出的PNG图片模糊

**解决方案**：
```matlab
% 增加分辨率
print('-dpng', '-r600', fullfile(output_dir, '图X-X.png'));

% 或使用矢量格式
print('-dsvg', fullfile(output_dir, '图X-X.svg'));
print('-dpdf', '-vector', fullfile(output_dir, '图X-X.pdf'));
```

---

### 场景3：坐标轴范围不合适

**问题**：曲线的关键特征被截断或过于分散

**解决方案**：
```matlab
% 手动设置坐标轴范围
xlim([26, 30]);  % X轴范围
ylim([0, 100]);  % Y轴范围

% 或使用自动紧凑范围
axis tight;
```

---

### 场景4：图例遮挡曲线

**问题**：图例位置不佳，遮挡重要内容

**解决方案**：
```matlab
% 调整图例位置
legend('曲线1', '曲线2', 'Location', 'northeast');

% 或放到图外
legend('曲线1', '曲线2', 'Location', 'eastoutside');

% 或使用文本标注替代图例
text(x, y, '标注文字', 'FontSize', 10);
```

---

### 场景5：子图间距过大/过小

**问题**：多子图布局不美观

**解决方案**：
```matlab
% 使用tiledlayout（推荐）
tiledlayout(2, 2, 'TileSpacing', 'compact', 'Padding', 'compact');
nexttile;
% 绘图...

% 或手动设置subplot位置
subplot('Position', [0.1, 0.55, 0.35, 0.35]);
```

---

## 图表与章节对应关系速查

| 图表文件前缀 | 对应章节 | 定稿文档 |
|-------------|---------|---------|
| `plot_fig_3_1_*` | 3.1 色散信道建模 | 第3章_3.1_*_final.md |
| `plot_fig_3_2_*` | 3.2 群时延特性 | 第3章_3.2_*_final.md（如有）或相关章节 |
| `plot_fig_3_3_*` | 3.3 调制机理 | 第3章_3.3_*_final.md |
| `plot_fig_3_4_*` | 3.4 适用性边界 | 第3章_3.4_*_final.md |
| `plot_fig_4_1_*` | 4.1 物理约束 | 第4章_4.1_*_final.md |
| `plot_fig_4_2_*` | 4.2 特征提取 | 第4章_4.2_*_final.md |
| `plot_fig_4_3_*` | 4.3 贝叶斯反演 | 第4章_4.3_*_final.md |
| `plot_fig_4_4_*` | 4.4 仿真验证 | 第4章_4.4_*_final.md |
| `plot_fig_5_*` | 第5章 | 第5章_*_final.md |

---

## 质量检查清单

### 修改前
- [ ] 已识别图表对应章节
- [ ] 已阅读对应定稿文档
- [ ] 已理解图表物理意义
- [ ] 已阅读现有代码逻辑
- [ ] 已明确修改范围和风险级别

### 修改后
- [ ] 代码可独立运行无错误
- [ ] 物理参数与定稿一致
- [ ] 视觉效果符合学术规范
- [ ] 图片已保存到正确目录
- [ ] 代码注释已更新
- [ ] 输出信息清晰准确

---

## 输出语言与格式

- **代码语言**：MATLAB
- **代码注释**：中文（关键术语可用英文）
- **图片格式**：PNG（300 DPI）+ SVG（矢量）
- **坐标轴标签**：中文或中英对照
- **图例**：中文
