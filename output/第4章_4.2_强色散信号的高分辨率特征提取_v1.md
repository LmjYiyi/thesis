# 4.2 强色散信号的高分辨率特征提取

第三章已从色散机理、误差解析和适用性边界三个维度,系统揭示了传统全频段FFT方法在强色散区的失效机制。研究表明,当工程判据 $B \cdot \eta \cdot \tau_0 > 1$ 时,差频信号演化为宽带Chirp信号,其频谱严重展宽且中心频率发生系统性偏移,峰值检测算法无法从模糊的频谱中准确提取物理参数。第4.1节进一步从反演理论的角度,论证了参数降维策略的物理正当性——固定碰撞频率$\nu_e$,仅反演电子密度$n_e$,从而有效规避了病态问题。

然而,降维策略的成功实施,依赖于一个关键的技术前提:**如何从非平稳的差频信号中,精确提取"频率-时延"特征轨迹**。这一问题的挑战在于:色散效应不仅破坏了信号的频域平稳性(频谱散焦),更在时域引入了瞬时频率的连续漂移(线性调频)。传统的全段FFT分析将整个调制周期$T_m$内的信号视为单一频率成分,这种"时间平均"的处理方式必然淹没了瞬时特性的演化细节,导致特征提取失败。

本节提出基于**滑动时间窗口**的短时分析框架，通过将长时观测分解为一系列局部平稳的短时切片，将非平稳信号特征提取问题转化为多个平稳片段的参数估计问题。具体而言，4.2.1节从物理逻辑层面阐释滑动窗口如何实现时频解耦与信号局部线性化；4.2.2节引入MDL准则，通过子空间维数检测剔除多径干扰；4.2.3节采用TLS-ESPRIT算法，在每个窗口内完成超分辨率频率估计，最终重构出完整的"频率-时延"特征轨迹，为后续的贝叶斯反演（第4.3节）提供高质量的观测数据。

为了直观展示时频解耦机制，图4-1对比了全频段FFT的尺度扭曲与滑动窗口的解耦效果。在全频段FFT频谱中，强色散导致的主瓣展宽和峰值偏移使得频率特征模糊不清；而滑动窗口提取的特征轨迹则清晰地呈现出离散点集，频率精度显著提升。这一对比验证了式(4-17)的探测频率刚性标定策略，有效绕过了色散参数的依赖性陷阱。

---

## 4.2.1 基于短时观测窗的时频解耦与局部信号线性化近似

### 全频段分析的参数依赖性循环困境

第三章推导的频率映射关系(式3-52及相关推导)揭示了差频频率$f$与发射频率$f_T$之间的理论联系。然而,该映射关系在实际应用中存在一个根本性的逻辑陷阱:映射公式高度依赖于色散参数$\alpha$,而$\alpha$本身是频率的强函数,需要通过待求参数$n_e$确定。这构成了参数依赖性循环困境——若要利用全频段频谱反推物理参数,必须预先知道色散特性;但色散特性正是我们试图诊断的目标量。

更严重的是,在强色散区,二阶色散系数$\tau_2(\omega)$随频率剧烈变化,泰勒展开中的"常数近似"假设被根本性破坏。这意味着整个频域的尺度发生了**非线性扭曲**——不同频段被拉伸或压缩的程度各不相同,全局频谱轴已经不再是均匀的线性刻度。此时,试图从畸变的频谱中直接读取峰值位置或展宽宽度,无异于在哈哈镜中测量物体的真实尺寸——观测结果已与物理真值失去了简单的对应关系。

---

## 4.2.1 基于短时观测窗的时频解耦与局部信号线性化近似



---

## 4.2.2 多径干扰下的信源数估计(MDL准则)与子空间净化

### 多径效应的物理来源与信号模型

在实际微波诊断环境中，差频信号往往不是理想的单径传播，而是包含了多个传播路径的叠加。典型的多径来源包括金属腔体反射、实验室等离子体诊断通常在金属腔体或微波暗室中进行，即便铺设吸波材料，仍存在微弱的壁面反射波；多层介质界面，等离子体鞘套可能呈现密度梯度分层结构，每一界面都会产生部分反射，形成多径回波；以及直达波与绕射波，在开放环境测量中，除直达路径外，信号可能经由障碍物边缘发生绕射后抵达接收端，形成附加路径。

在滑动窗口$i$内，若存在$M$条传播路径，则接收到的短时信号可建模为多个复正弦波的叠加$s_{win}^{(i)}(t) = \sum_{m=1}^{M} A_m e^{j(2\pi f_m t + \phi_m)} + n(t)$（式4-23），其中$A_m, f_m, \phi_m$分别为第$m$条路径对应的幅度、频率和初相位，$n(t)$为加性高斯白噪声。注意，由于反射路径必然长于直达路径，其对应的传播时延更大，因而差频频率$f_m$也更高，$f_1 < f_2 < \cdots < f_M$（式4-24），其中$f_1$对应直达波（我们真正关心的物理量），$f_2, \ldots, f_M$为多径干扰分量。

### 信源数估计的必要性:防止多径混叠

若不进行信源数检测，直接将接收信号送入频率估计算法（如ESPRIT），会产生两类严重后果。欠估计（假设单径实际多径）时，若算法被强制设定为单信源模式，将把多径信号的能量强制拟合为一个等效频率，该频率既不代表直达波也不代表反射波，而是二者的加权平均，完全丧失物理意义。过估计（假设多径实际单径）时，若算法被强制设定为多信源模式（如$k=3$），而实际仅有单一直达波，算法会将噪声子空间中的虚假特征值误判为信号，输出不存在的虚假特征值，导致后续数据筛选失败。因此，在频率估计之前，必须首先进行模型阶数识别（Model Order Selection），即自动检测窗口内实际存在的独立信源数量$k$。这一步骤称为信源数估计或子空间维数检测。

### MDL准则的信息论基础

最小描述长度（MDL）准则是由Rissanen于1978年提出的模型选择准则，其核心思想源自信息论中的奥卡姆剃刀原理：在能够同样好地解释数据的多个模型中，应选择复杂度最低的模型。在信源数估计问题中，"复杂度"体现为信号子空间的维数$k$，而"解释数据的好坏"通过数据的似然函数衡量。考虑$L$次快拍得到的观测数据矩阵$\mathbf{X} \in \mathbb{C}^{M \times L}$，其样本协方差矩阵为$\mathbf{R} = \frac{1}{L} \mathbf{X} \mathbf{X}^H$（式4-25）。对$\mathbf{R}$进行特征值分解，得到降序排列的特征值$\{\lambda_1 \ge \lambda_2 \ge \cdots \ge \lambda_M\}$。在理想情况下，前$k$个大特征值对应信号子空间，后$M-k$个小特征值对应噪声子空间且理论上应相等（噪声方差$\sigma^2$）。

MDL准则通过构造代价函数，在模型拟合优度（似然项）与模型复杂度（惩罚项）之间取得平衡：$\text{MDL}(k) = -\ln \mathcal{L}(k) + \frac{1}{2} p(k) \ln L$（式4-26），其中$\mathcal{L}(k)$为假设信源数为$k$时的最大似然函数，$p(k)$为自由参数个数（模型复杂度）。

### MDL公式的显式推导

对于复高斯白噪声背景下的正弦信号模型，Wax和Kailath于1985年推导出MDL准则的闭式表达式。关键步骤如下：假设信源数为$k$，则噪声子空间包含$M-k$个特征值$\{\lambda_{k+1}, \ldots, \lambda_M\}$。在噪声子空间中，理论上所有特征值应相等，但实际受到有限快拍估计误差影响而呈现随机起伏。最大似然估计下，噪声方差的估计为噪声特征值的算术平均$\hat{\sigma}^2(k) = \frac{1}{M-k} \sum_{j=k+1}^{M} \lambda_j$（式4-27）。而似然函数正比于特征值的几何平均与算术平均的比值$\mathcal{L}(k) \propto \frac{\left( \prod_{j=k+1}^{M} \lambda_j \right)^{\frac{1}{M-k}}}{\frac{1}{M-k} \sum_{j=k+1}^{M} \lambda_j}$（式4-28）。模型自由参数个数为$p(k) = k(2M - k)$（式4-29），这是因为每个信源需要估计方向向量（复数，占$2M$个实参数）和功率（1个参数），共$k(2M+1)$个；但由于噪声方差共用，需减去$k$，最终得式(4-29)。

综合上述推导，MDL准则的最终形式为$\text{MDL}(k) = -L(M-k) \ln\left( \frac{\prod_{j=k+1}^{M} \lambda_j^{\frac{1}{M-k}}}{\frac{1}{M-k} \sum_{j=k+1}^{M} \lambda_j} \right) + \frac{1}{2} k(2M-k) \ln L$（式4-30）。信源数估计策略为遍历$k = 0, 1, \ldots, M-1$，计算每个候选值对应的$\text{MDL}(k)$，选择使代价函数最小的$\hat{k}$作为信源数估计：$\hat{k} = \arg\min_{k} \text{MDL}(k)$（式4-31）。

### 子空间净化与信号分量筛选

确定信源数$\hat{k}$后，协方差矩阵的特征空间被正式划分为两个正交子空间：信号子空间，由前$\hat{k}$个特征向量$\{\mathbf{e}_1, \ldots, \mathbf{e}_{\hat{k}}\}$张成，包含所有信号分量的结构信息；噪声子空间，由后$M-\hat{k}$个特征向量$\{\mathbf{e}_{\hat{k}+1}, \ldots, \mathbf{e}_M\}$张成，仅包含随机噪声。在后续的ESPRIT算法（4.2.3节）中，仅使用信号子空间的特征向量进行频率估计，噪声子空间被完全舍弃。这一过程称为子空间净化，其物理意义是：通过特征分解，将接收信号中的有用成分与无用噪声在线性代数层面严格分离，从而提升频率估计的信噪比和分辨率。

对于等离子体诊断应用，通常检测出$\hat{k}=2\sim3$个信源（直达波+1~2条反射路径）。在提取的$\hat{k}$个频率分量$\{f_1, f_2, \ldots, f_{\hat{k}}\}$中，根据物理判据选择频率最小的分量作为直达波的差频$f_{beat}^{(i)} = \min\{f_1, f_2, \ldots, f_{\hat{k}}\}$（式4-32）。该准则的物理依据是：直达路径最短，时延最小，对应差频最低。这一筛选策略在绝大多数实验场景中有效，除非存在强多普勒效应或时变介质引入的额外频移，此时需结合幅度信息或时域相关性进一步判别。

图4-2量化了MDL准则的检测性能。在典型多径场景下，随着候选信源数k的增加，MDL代价值呈现先降后升的趋势，最小值对应真实信源数$\hat{k}=2$（直达波+1条反射路径）。这一自适应检测有效避免了欠估计或过估计的错误，确保子空间净化的准确性。

---

## 4.2.3 基于TLS-ESPRIT的"频率-时延"特征轨迹高精度重构

### ESPRIT算法的子空间旋转不变性原理

ESPRIT（Estimation of Signal Parameters via Rotational Invariance Techniques）算法是由Roy和Kailath于1989年提出的经典超分辨率频率估计方法，其核心思想是利用阵列信号的旋转不变结构直接从信号子空间中提取频率参数，而无需进行谱峰搜索。这使得ESPRIT在计算效率和估计精度上均显著优于传统的MUSIC算法。

考虑均匀线性阵列（Uniform Linear Array, ULA）接收到的$k$个复正弦信号。定义空间频率$\omega_m = 2\pi f_m \Delta t$，其中$\Delta t$为采样间隔。构造两个子阵列：第一个子阵由前$M-1$个阵元组成，第二个由后$M-1$个阵元组成（即将整个阵列错位一个单元）。关键洞察在于：这两个子阵列接收到的信号具有相同的幅度和方向结构，仅在相位上存在固定的旋转因子。数学上，记第一子阵的方向矩阵为$\mathbf{A}_1$，第二子阵的为$\mathbf{A}_2$，则存在对角旋转矩阵$\boldsymbol{\Phi}$：$\mathbf{A}_2 = \mathbf{A}_1 \boldsymbol{\Phi}$（式4-33），其中$\boldsymbol{\Phi} = \text{diag}(e^{j\omega_1}, e^{j\omega_2}, \ldots, e^{j\omega_k})$。由于信号子空间$\mathbf{E}_s = [\mathbf{e}_1, \ldots, \mathbf{e}_k]$与方向矩阵$\mathbf{A}$张成相同的列空间，上述旋转关系在子空间层面同样成立：$\mathbf{E}_{s2} = \mathbf{E}_{s1} \boldsymbol{\Psi}$（式4-34），其中$\mathbf{E}_{s1}, \mathbf{E}_{s2}$分别为对应两个子阵的信号特征向量，$\boldsymbol{\Psi}$为等效旋转矩阵。关键步骤是求解$\boldsymbol{\Psi}$的特征值，其幅角直接给出空间频率$\omega_m$：$\lambda_m = e^{j\omega_m} \implies \omega_m = \angle \lambda_m$（式4-35）。进而反算物理频率$f_m = \frac{\omega_m}{2\pi \Delta t}$（式4-36）。

### 总体最小二乘(TLS)求解旋转矩阵的鲁棒性提升

标准ESPRIT使用最小二乘（Least Squares, LS）法求解式(4-34)中的$\boldsymbol{\Psi}$：$\boldsymbol{\Psi}_{LS} = (\mathbf{E}_{s1}^H \mathbf{E}_{s1})^{-1} \mathbf{E}_{s1}^H \mathbf{E}_{s2}$（式4-37）。然而，LS方法隐含假设$\mathbf{E}_{s1}$为无误差的完美矩阵，仅$\mathbf{E}_{s2}$受噪声污染。这在实际中并不成立——由于有限快拍数和估计误差，两个子空间矩阵均包含噪声扰动。为了提升鲁棒性，采用总体最小二乘（Total Least Squares, TLS）方法，同时考虑两侧矩阵的误差：$\min_{\boldsymbol{\Psi}} \|[\mathbf{E}_{s1}, \mathbf{E}_{s2}] - [\tilde{\mathbf{E}}_{s1}, \tilde{\mathbf{E}}_{s2}]\|_F \quad \text{s.t.} \quad \tilde{\mathbf{E}}_{s2} = \tilde{\mathbf{E}}_{s1} \boldsymbol{\Psi}$（式4-38）。

TLS解可通过对增广矩阵$[\mathbf{E}_{s1}, \mathbf{E}_{s2}]$进行奇异值分解（SVD）获得。具体算法流程如下：步骤1，构造增广矩阵并进行SVD：$\begin{bmatrix} \mathbf{E}_{s1} \\ \mathbf{E}_{s2} \end{bmatrix} = \mathbf{U} \boldsymbol{\Sigma} \mathbf{V}^H = [\mathbf{U}_1, \mathbf{U}_2] \begin{bmatrix} \boldsymbol{\Sigma}_1 & \\ & \boldsymbol{\Sigma}_2 \end{bmatrix} \begin{bmatrix} \mathbf{V}_1^H \\ \mathbf{V}_{21}^H \end{bmatrix}$（式4-39），其中$\boldsymbol{\Sigma}_1$包含$k$个主奇异值，$\boldsymbol{\Sigma}_2$为噪声奇异值。步骤2，提取$\mathbf{V}$矩阵的分块子矩阵：$\mathbf{V}_1 = \begin{bmatrix} \mathbf{V}_{11} \\ \mathbf{V}_{21} \end{bmatrix}, \quad \mathbf{V}_{11}, \mathbf{V}_{21} \in \mathbb{C}^{k \times k}$（式4-40）。步骤3，TLS解为：$\boldsymbol{\Psi}_{TLS} = -\mathbf{V}_{11} \mathbf{V}_{21}^{-1}$（式4-41）。步骤4，对$\boldsymbol{\Psi}_{TLS}$进行特征分解：$\boldsymbol{\Psi}_{TLS} \mathbf{v}_m = \lambda_m \mathbf{v}_m, \quad m = 1, \ldots, k$（式4-42）。步骤5，提取频率估计：$\hat{f}_m = \frac{1}{2\pi \Delta t} \angle(\lambda_m)$（式4-43）。TLS-ESPRIT相较于LS-ESPRIT的优势在于：在低信噪比或小快拍数场景下，其估计均方误差（MSE）更接近克拉美-罗下界（CRLB），鲁棒性显著提升。

### 完整特征轨迹的重构流程

鉴于算法模块的系统集成，我们综述完整的频率-时延特征轨迹提取流程：以时域差频信号$s_D(t)$、调频斜率$K$及起始频率$f_0$为输入，循环遍历$i = 1$至$N$的窗口。首先定位时间，依据$t_i = i \cdot \Delta T / (1 - \rho)$计算窗口中心（重叠率$\rho$确保连续性）；刚性标定探测频率$f_{probe}^{(i)} = f_0 + K \cdot t_i$，摆脱介质依赖；提取短时信号$s_{win}^{(i)}(t) = s_D(t) \cdot w(t - t_i)$，局部化非平稳特性；估计协方差$\mathbf{R}^{(i)}$，构造$M \times L$观测矩阵；运用MDL准则遍历$k$确定$\hat{k}^{(i)}$，净化子空间；应用TLS-ESPRIT提取$\hat{k}^{(i)}$个频率分量；筛选最低频率$f_{beat}^{(i)}$作为直达波；计算时延$\tau_{meas}^{(i)} = f_{beat}^{(i)} / K$；存储坐标点至数据集$\mathcal{D}$。最终输出$\mathcal{D} = \{(f_{probe}^{(i)}, \tau_{meas}^{(i)})\}_{i=1}^{N}$，该集描绘了表观时延随探测频率的轨迹，为贝叶斯反演提供精确观测基础。

该数据集中的每个坐标点$(f, \tau)$清晰地标定了在探测频率$f$处，测得的表观传播时延为$\tau$这一物理关系，为后续第4.3节的贝叶斯非线性反演提供了高质量的观测输入。

### 超分辨率性能与FFT的对比优势

TLS-ESPRIT之所以被称为超分辨率算法，在于其频率估计精度不受FFT栅栏效应的限制。传统FFT的频率分辨率由采样时长$T_{win}$严格确定为$\delta f = 1/T_{win}$，且估计值必然落在离散频率网格上（$f = k/T_{win}, k \in \mathbb{Z}$）。而ESPRIT基于子空间特征分解，理论上可估计任意连续频率值，其分辨率主要受信噪比和快拍数约束，而非时长限制。

图4-3对比了TLS-ESPRIT与FFT的频率估计误差。在窗口长度$T_{win} = 10$ µs，信噪比SNR = 20 dB，双信源间隔$\Delta f = 2$ kHz的场景下，FFT方法的频率分辨率$\delta f = 100$ kHz，两个信源完全无法分辨，频谱呈现单一主瓣；而TLS-ESPRIT可准确分离并估计两个频率，估计误差约100 Hz（相对误差5%），远优于FFT的100 kHz分辨率。这种超分辨率能力对于强色散区诊断至关重要——当差频频谱严重展宽时，传统FFT已无法提供有效的频率信息，而ESPRIT仍能从信号子空间结构中提取精确的参数，确保特征轨迹的高精度重构。

---

## 本节小结

本节系统建立了基于滑动时间窗口的强色散信号高分辨率特征提取框架，为后续的贝叶斯非线性反演奠定了数据基础。主要研究成果总结如下：

滑动窗口的时频解耦机制（4.2.1）。通过以时间定频率的刚性映射策略，打破了全频段分析中参数依赖性的循环困境。在足够短的观测窗内，非平稳差频信号被线性化为准单频成分，从而将复杂的时频联合估计问题解耦为一系列独立的局部频率提取任务，构建出无尺度扭曲的频率-时延特征坐标点集。

MDL准则的子空间净化（4.2.2）。针对实际环境中的多径干扰问题，引入信息论驱动的模型阶数识别方法，通过几何平均与算术平均的似然比检验，自适应确定信号子空间维数，将噪声成分从协方差矩阵中严格分离，为后续频率估计提供净化的信号子空间，有效抑制反射波引入的虚假峰值。

TLS-ESPRIT的超分辨率重构（4.2.3）。利用子空间旋转不变性原理，绕过FFT栅栏效应的分辨率限制，直接从特征分解中提取连续频率参数。相较于标准最小二乘方法，总体最小二乘求解策略通过同时考虑两侧子空间的估计误差，显著提升了低信噪比场景下的鲁棒性，确保特征轨迹的高精度重构，为下一节的加权非线性拟合提供可靠的观测数据。

综上所述，本节提出的滑动窗口+MDL+TLS-ESPRIT三级处理链，从时频解耦、多径抑制到超分辨估计三个层面，系统解决了强色散非平稳信号的特征提取难题，将传统方法失效的宽带模糊波形，转化为清晰的离散特征点集，为第4.3节基于加权似然函数的MCMC贝叶斯反演提供了高质量的输入，确保了参数降维策略在工程实践中的成功实施。


