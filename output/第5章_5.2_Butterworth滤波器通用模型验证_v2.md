# 5.2 Butterworth滤波器通用模型验证

第5.1节通过Lorentz超材料实验验证了所提反演方法在谐振型色散系统中的有效性。然而，无论是Drude等离子体还是Lorentz超材料，两者均属于电磁介质范畴——其色散特性均源于物质对电磁场的响应，且群时延表达式中均包含"介质厚度$d$"这一关键的空间尺度参数。为突破这一物理实体的局限性，本节引入Butterworth滤波器作为验证对象，从而将算法的应用边界从"**介质参数反演**"拓展至更一般化的"**系统辨识**"范畴。

Butterworth滤波器是纯电路网络系统，其群时延特性完全由电路拓扑（LC谐振网络的级联组合）决定，不涉及任何物理传播介质。这意味着滤波器的群时延表达式中不存在"厚度$d$"这一概念——时延的绝对数值由电路参数（中心频率$F_0$、通带带宽$BW$、滤波器阶数$N$）唯一确定，而非由电磁波在某种介质中的传播路径长度决定。这一本质差异使得滤波器验证具有独特的方法学价值：**若所提算法能够有效处理这种"无物理实体"的群时延数据，则充分证明了该方法已超越特定物理机制的约束，成为一种通用的"系统传递函数辨识工具"。**

本节的研究目标因此具有三重意义：其一，验证"滑动窗口-ESPRIT-MCMC"框架能否处理非奇异型、非介质型的色散函数；其二，探索三参数联合反演的可行性边界；其三，为算法在更广泛工程系统（如光纤、射频器件、机电系统）中的应用奠定理论基础。

---

## 5.2.1 滤波器群时延模型与色散特性分析

### Butterworth滤波器的频域特性

Butterworth滤波器以其通带内最大平坦响应而著称，是模拟与数字滤波器设计的基础原型。对于$N$阶Butterworth低通滤波器，其归一化幅度响应的平方为：

$$|H_{LP}(\Omega)|^2 = \frac{1}{1 + \Omega^{2N}} \tag{5-15}$$

其中$\Omega = \omega/\omega_c$为归一化角频率，$\omega_c$为截止角频率。通过低通到带通的频率变换$\Omega \to (f - F_0)/(BW/2)$，可得到带通Butterworth滤波器的幅度响应：

$$|H_{BP}(f)|^2 = \frac{1}{1 + \left(\frac{f - F_0}{BW/2}\right)^{2N}} \tag{5-16}$$

上式表明，幅度响应在中心频率$F_0$处达到最大值1，并随着频率偏离中心向两侧衰减，衰减速率由阶数$N$决定。

### 群时延解析模型

Butterworth滤波器的群时延可通过相位响应对频率的负导数获得。对于$N$阶带通滤波器，其群时延的解析表达式为：

$$\tau_g(f; F_0, BW, N) = \frac{2N}{\pi \cdot BW} \cdot \left[1 + \left(\frac{f - F_0}{BW/2}\right)^2\right]^{-\frac{N+1}{2}} \tag{5-17}$$

该公式具有清晰的物理内涵：群时延在中心频率$F_0$处达到峰值$\tau_{g,max} = 2N/(\pi \cdot BW)$，表现为信号包络通过滤波器网络时经历的最大延迟；随着频率偏离中心，时延按代数幂律形式$(1+x^2)^{-(N+1)/2}$逐渐衰减至零。这种"中心峰值、两侧衰减"的钟形分布与Drude模型的"截止区发散、高频衰减"形成鲜明对比，代表了另一类典型的色散曲线拓扑结构。

值得强调的是，式(5-17)中**不包含任何空间尺度参数**——这与Drude模型的$\tau_g = (d/c)[1-(f_p/f)^2]^{-1/2}$形成本质区别。后者的群时延与介质厚度$d$成正比，而前者的时延幅度完全由电路参数$(N, BW)$决定。这一差异正是本节验证价值的核心所在：算法需要在缺失"传播距离"这一物理锚点的情况下，仅凭群时延曲线的"形状"信息完成参数辨识。

引入归一化频率偏移量$x = (f - F_0)/(BW/2)$，式(5-17)可简化为：

$$\tau_g(x) = \tau_{g,max} \cdot (1 + x^2)^{-\frac{N+1}{2}}, \quad \text{其中 } \tau_{g,max} = \frac{2N}{\pi \cdot BW} \tag{5-18}$$

### 模型参数的物理意义

式(5-17)揭示了三个独立参数对群时延曲线拓扑结构的控制作用：

**中心频率$F_0$**决定了群时延峰值在频率轴上的位置。改变$F_0$将导致整条曲线沿频率轴平移，而不改变其形状。在反演问题中，$F_0$通过控制峰值位置对观测数据产生一阶影响，理论上应属于强可观测参数。

**通带带宽$BW$**同时影响峰值幅度（反比关系）与曲线展宽程度（正比关系）。较窄的带宽产生尖锐的高峰，较宽的带宽产生平缓的低峰。这种"高度-宽度"的耦合效应使$BW$的独立辨识存在一定挑战。

**滤波器阶数$N$**主要控制曲线的陡峭程度。高阶滤波器在通带边缘产生更急剧的时延变化，低阶滤波器则呈现平缓过渡。由于$N$在工程上通常为正整数，其反演可能呈现离散特征。

### 与LFMCW体制的兼容性分析

将Butterworth滤波器置于LFMCW诊断框架中，需要考察群时延的频变特性对差频信号的调制效应。设LFMCW信号的扫频范围为$[f_{start}, f_{end}]$，覆盖滤波器通带的主要区域。当探测信号从低频向高频扫描时，群时延将经历"上升→峰值→下降"的演化过程。

这种非单调的时延特性将导致差频信号呈现特殊的非平稳行为。在扫频的前半段（$f < F_0$），时延随频率增加而增大，对应差频频率的上升趋势；在扫频的后半段（$f > F_0$），时延随频率增加而减小，对应差频频率的下降趋势。这种"抛物线型"的瞬时频率轨迹有别于Drude模型的"单调下降"特征，为算法的通用性检验提供了差异化场景。

---

## 5.2.2 多参数联合反演（$F_0$, $BW$, $N$）结果与精度评估

### 仿真环境配置

为验证所提方法对Butterworth滤波器的反演能力，本节基于MATLAB构建了完整的"信号生成→传播仿真→特征提取→参数反演"闭环验证平台。关键仿真参数配置如表5-7所示。

**表5-7 Butterworth滤波器LFMCW仿真参数配置**

| 参数类别 | 参数符号 | 物理含义 | 数值 | 单位 |
|---------|---------|---------|------|------|
| **LFMCW信号** | $f_{start}$ | 扫频起始频率 | 10 | GHz |
| | $f_{end}$ | 扫频终止频率 | 18 | GHz |
| | $B$ | 扫频带宽 | 8 | GHz |
| | $T_m$ | 调制周期 | 100 | $\mu$s |
| | $K$ | 调频斜率 | $8 \times 10^{13}$ | Hz/s |
| | $f_s$ | 仿真采样率 | 40 | GHz |
| **滤波器真值** | $F_0$ | 中心频率 | 14 | GHz |
| | $BW$ | 通带带宽 | 8 | GHz |
| | $N$ | 滤波器阶数 | 5 | — |
| **非理想特性** | $R_{pb}$ | 通带纹波 | 1.2 | dB |
| | $IL$ | 插入损耗 | 2.0 | dB |
| | $DR$ | 系统动态范围 | 90 | dB |

上述参数的选取遵循以下设计原则：

**宽频覆盖**：LFMCW的扫频范围（10–18 GHz）完整覆盖了滤波器的通带（$F_0 \pm BW/2 = 10$–18 GHz），确保探测信号能够采样到群时延曲线的完整形态，包括上升段、峰值区与下降段。

**非理想模拟**：为提高仿真的工程真实性，在理想Butterworth幅度响应基础上叠加了通带纹波（模拟谐振腔耦合非理想性）、插入损耗（模拟有耗元件衰减）及系统底噪（模拟接收机热噪声）。这些非理想特性参考了典型微波滤波器的数据手册指标。

### 频域传递函数建模

与第5.1节采用CST S参数不同，本节直接在频域构建Butterworth滤波器的理论传递函数。其核心步骤如下：

**群时延计算**：按式(5-17)计算频率轴上每个点的理论群时延$\tau_g(f)$。

**相位重构**：基于群时延的物理定义$\tau_g = -d\phi/d\omega$，通过累积积分恢复相位响应：

$$\phi(f) = -\int_0^f 2\pi \tau_g(f') df' \tag{5-19}$$

数值实现采用累积求和近似：$\phi[k] = -\sum_{i=0}^{k} \tau_g[i] \cdot \Delta\omega$。

**幅度与相位合成**：将式(5-16)的幅度响应与上述相位响应组合，得到复传递函数：

$$H_{filter}(f) = |H_{BP}(f)| \cdot e^{j\phi(f)} \cdot e^{-j2\pi f \tau_{ref}} \tag{5-20}$$

其中$\tau_{ref} = 2$ ns为参考通道的固定时延。

这种"相位=群时延积分"的建模方法确保了传递函数的物理自洽性——所产生的相位响应在数学上严格对应于预设的群时延模型，避免了直接设定相位可能引入的模型不一致问题。

### 差频信号特征分析

图5-8展示了经过Butterworth滤波器后差频信号的时域与频域特征。

![图5-8 Butterworth滤波器差频信号特征](figures/图5-8_滤波器差频信号.png)

**时域特征**（图5-8a）：差频信号的包络呈现平缓的调制特征，这与Lorentz模型在谐振点附近的急剧衰减形成对比。信号幅度在通带中心（14 GHz附近）保持最大值，至通带边缘（10 GHz与18 GHz）衰减约3 dB，呈现典型的带通滤波包络特征。

**频域特征**（图5-8b）：差频信号的FFT频谱呈现显著的双峰结构。这一特征可从群时延的非单调性获得解释：当探测频率在中心频率两侧对称位置时，对应相同的群时延值，进而产生相同的差频频率。双峰的分离程度反映了时延曲线的"峰宽"特性，而非传统测距中的多目标现象。这种双峰散焦再次验证了传统FFT方法在色散条件下的失效。

### ESPRIT特征提取结果

采用第4.2节建立的"滑动窗口-MDL-ESPRIT"框架对差频信号进行处理。关键参数配置为：窗口时长8 $\mu$s，窗口重叠率87.5%，降采样因子150。

图5-9展示了ESPRIT提取的"频率-时延"特征轨迹与理论曲线的对比。

![图5-9 滤波器ESPRIT特征提取](figures/图5-9_滤波器ESPRIT特征.png)

如图5-9所示，ESPRIT提取的特征点（蓝色散点）在整个频率范围内紧密贴合红色理论曲线。值得注意的是，曲线呈现典型的"钟形"分布——在中心频率14 GHz附近达到峰值约1.9 ns，向两侧逐渐衰减。散点颜色深浅反映了信号幅度权重的分布：通带中心权重最高（颜色最深），通带边缘权重逐渐降低。定量评估表明，特征提取的RMSE约为**0.08 ns**，相对于最大时延的相对误差低于5%，与Drude和Lorentz模型的精度水平一致。

### MCMC三参数联合反演

基于ESPRIT提取的特征数据，运行Metropolis-Hastings MCMC算法反演Butterworth模型的三个参数。待反演参数向量为$\boldsymbol{\theta} = [F_0, BW, N]^T$，采样配置如表5-8所示。

**表5-8 Butterworth滤波器MCMC反演参数配置**

| 参数类别 | 参数符号 | 物理含义 | 数值 | 单位 |
|---------|---------|---------|------|------|
| **先验分布** | $F_0$ | 中心频率范围 | [11, 17] | GHz |
| | $BW$ | 带宽范围 | [4, 12] | GHz |
| | $N$ | 阶数范围 | [1.5, 10] | — |
| **提议分布** | $\sigma_{F_0}$ | 中心频率步长 | 0.09 | GHz |
| | $\sigma_{BW}$ | 带宽步长 | 0.16 | GHz |
| | $\sigma_N$ | 阶数步长 | 0.26 | — |
| **采样规模** | $N_{samples}$ | 总采样次数 | 10000 | 次 |
| | $N_{burn}$ | 预烧期 | 2000 | 次 |
| **噪声模型** | $\sigma_{meas}$ | 测量噪声标准差 | 0.05 | ns |

需要指出的是，滤波器阶数$N$在MCMC中作为连续变量处理，最终反演结果取四舍五入的整数值。这种处理方式既保证了采样的连续性，又符合工程实际中阶数取整的物理约束。

### 后验分布分析

图5-10以迹线图与后验直方图的形式展示了MCMC采样结果。

![图5-10 Butterworth滤波器MCMC反演结果](figures/图5-10_滤波器MCMC结果.png)

**迹线图分析**（图5-10a-c）：

- **中心频率$F_0$**：采样链在预烧期后迅速收敛至真值（14 GHz）附近，振荡幅度极小，呈现典型的混合良好特征
- **通带带宽$BW$**：收敛速度略慢于$F_0$，但预烧期后同样稳定在真值（8 GHz）附近
- **滤波器阶数$N$**：振荡幅度相对较大，表明数据对该参数的约束弱于前两者

**后验分布分析**（图5-10d-f）：

丢弃预烧期后，对8000个有效样本进行直方图统计。表5-9汇总了后验统计量与真值对比。

**表5-9 Butterworth滤波器MCMC反演结果汇总**

| 参数 | 真值 | 后验均值 | 后验标准差 | 95% CI | 相对误差 | CV |
|-----|------|---------|-----------|--------|---------|-----|
| $F_0$ (GHz) | 14.00 | 13.98 | 0.04 | [13.90, 14.06] | **0.14%** | 0.29% |
| $BW$ (GHz) | 8.00 | 7.92 | 0.35 | [7.25, 8.60] | 1.00% | 4.42% |
| $N$ (—) | 5 | 4.85 | 0.48 | [3.95, 5.82] | 3.00% | 9.90% |

**核心发现**：

1. **$F_0$的高精度反演**：后验均值13.98 GHz与真值14.00 GHz仅差0.02 GHz，相对误差低于**0.2%**。后验分布呈现尖锐的单峰形态，变异系数CV = 0.29%，远低于5%的可观测性阈值。这验证了中心频率作为"决定曲线峰值位置"的主参数，具有最强的可观测性。

2. **$BW$的中等精度反演**：后验均值7.92 GHz，相对误差约1%，CV = 4.42%，处于可观测边界。$BW$的敏感性弱于$F_0$的物理原因在于：带宽同时影响峰值高度与曲线展宽，两种效应存在部分冗余——较窄的高峰与较宽的低峰可能产生相似的积分时延效应。

3. **$N$的弱可观测性**：后验均值4.85，取整后为5，与真值一致。然而CV = 9.90%接近10%的警戒线，表明数据对阶数的约束相对有限。$N$主要影响曲线的"陡峭程度"，而非整体位置或面积，属于二阶几何特征，敏感性低于前两者。

### 参数相关性分析

图5-11以Corner Plot形式展示了三参数的联合后验结构。

![图5-11 Butterworth参数联合后验分布Corner Plot](figures/图5-11_滤波器CornerPlot.png)

Corner Plot的下三角区域展示了两两参数的联合散点分布：

- **$F_0$-$BW$联合分布**：散点呈轻微的正相关条带结构（$\rho = 0.15$），表明当$F_0$估计偏高时，$BW$也倾向于轻微偏高。这种弱相关可解释为：中心频率的微小偏移可部分由带宽的调整来补偿拟合残差
- **$F_0$-$N$联合分布**：近乎圆形分布（$\rho = 0.08$），表明两参数接近独立
- **$BW$-$N$联合分布**：呈现显著的负相关（$\rho = -0.42$），物理原因是$BW$与$N$共同决定峰值高度$\tau_{max} = 2N/(\pi BW)$——较大的$BW$可由较大的$N$补偿以维持峰值不变

$BW$与$N$之间的负相关揭示了三参数联合反演中存在的参数耦合问题。尽管整体反演精度可接受，但在实际应用中若阶数已知（如根据滤波器设计文档），将$N$固定可显著提高$BW$的反演精度。

### 拟合验证与置信带

图5-12展示了基于MCMC后验均值的理论曲线、真值曲线与95%置信带。

![图5-12 MCMC拟合验证](figures/图5-12_滤波器拟合验证.png)

后验均值曲线（红色实线）与真值曲线（绿色虚线）在图示精度内高度重合。灰色半透明区域为从后验样本中随机抽取100条曲线叠加形成的95%置信带，该置信带完整覆盖了观测数据点。定量评估表明，拟合残差的加权RMSE约为**0.06 ns**，与测量噪声估计值$\sigma_{meas} = 0.05$ ns处于同一量级。

---

## 5.2.3 算法普适性结论：从介质诊断到通用系统辨识

### 三类色散模型的系统性对比

通过第四章（Drude等离子体）、第5.1节（Lorentz超材料）与本节（Butterworth滤波器）的系统验证，可对所提反演算法的适用范围进行全面评估。表5-10汇总了三类色散模型的关键特征与反演结果对比。

**表5-10 三类色散模型反演结果系统性对比**

| 特征维度 | Drude等离子体 | Lorentz超材料 | Butterworth滤波器 |
|---------|--------------|--------------|------------------|
| **物理机制** | 自由电子气响应 | 束缚电子谐振 | LC网络级联 |
| **介电模型** | $\tilde{\varepsilon} = 1 - \frac{\omega_p^2}{\omega^2+j\omega\nu_e}$ | $\tilde{\varepsilon} = 1 + \frac{\omega_p^2}{\omega_0^2 - \omega^2 - j\gamma\omega}$ | 非介电（传递函数） |
| **群时延形态** | 截止区发散 | 谐振点尖峰 | 中心对称钟形 |
| **空间尺度依赖** | $\tau_g \propto d$ | $\tau_g \propto d_{eff}$ | **无**（纯电路参数） |
| **待反演参数** | $n_e$（或$f_p$）, $\nu_e$ | $f_{res}$, $\gamma$ | $F_0$, $BW$, $N$ |
| **主参数CV** | 1.5% ($n_e$) | 0.14% ($f_{res}$) | 0.29% ($F_0$) |
| **次级参数CV** | 54% ($\nu_e$) | 48.6% ($\gamma$) | 4.42%–9.90% ($BW$, $N$) |
| **主参数误差** | <1% | 0.06% | 0.14% |

从表5-10可以提炼出三条普适性规律。首先，**主参数的高精度反演是普遍特征**——无论色散机制如何，决定群时延曲线"关键拓扑特征"的参数（截止频率、谐振频率或中心频率）均能被MCMC精确约束，后验CV普遍低于2%，反演误差控制在1%以内。其次，**参数敏感性分级具有物理普适性**——在所有模型中均存在"主参数-次级参数"的清晰分级，主参数决定曲线形状的一阶特征（位置、拐点），次级参数影响二阶特征（幅度缩放、陡峭程度），后者的可观测性显著弱于前者。最后，**模型复杂度与参数耦合效应相关**——随着待反演参数数量增加，参数间的相关性增强，如Butterworth模型的三参数反演中出现了$BW$-$N$的负相关（$\rho = -0.42$），提示多参数反演需谨慎处理参数耦合问题。

### 从"介质参数反演"到"系统辨识"的方法学跃升

本节Butterworth滤波器验证的核心价值，在于证明了所提方法已超越"介质诊断"的原始应用范畴，具备了通用"系统辨识工具"的属性。这一跃升体现在以下三个层面。

**空间尺度的解耦**：在Drude与Lorentz模型中，群时延的绝对数值始终与"介质厚度$d$"耦合——厚度越大，时延越长。然而Butterworth滤波器的群时延完全由电路参数决定，不存在任何空间尺度。算法成功反演了滤波器参数，表明其核心能力在于识别"群时延曲线的形状"，而非依赖任何特定的物理传播机制。

**物理机制的超越**：三类验证对象的色散机制迥异——等离子体源于自由电子的集体振荡，超材料源于束缚电子的谐振响应，而滤波器源于LC网络的相位累积。算法对所有这些机制均表现出良好的适应性，说明其本质是一种**数学形式驱动**的反演方法，只要目标系统的传递函数具有明确的参数化表达式，均可纳入本框架进行处理。

**因果律作为统一约束**：尽管三类系统的物理机制不同，但它们均满足线性、被动、因果律约束。根据Kramers-Kronig关系，因果律保证了系统响应函数的实部（色散）与虚部（吸收）之间存在严格的希尔伯特变换关系。这意味着群时延曲线的"形状"不是任意的，而是由系统的因果响应唯一确定。MCMC反演本质上是对这种因果约束下参数-观测量映射关系的统计逆求解。

### 适用范围界定与工程推广前景

综合上述分析，可将所提反演方法的适用边界从物理机制与工程条件两个层面加以界定。在物理约束方面，凡满足线性、被动及因果律的系统，只要其群时延函数连续可微且具有明确的参数化表达式，均可纳入本框架的反演范畴；此外，探测频率范围需能覆盖群时延曲线的主要变化区域，以确保特征提取的信息完备性。

基于这些条件，该方法可望推广至多个工程领域：在光纤通信中可用于色散补偿模块的在线特性表征，在微波系统中可实现滤波器、移相器等无源器件的群时延精确测量，而对于铁氧体材料或基于Debye模型的生物组织，亦可探索其介电谱诊断的可行性。

需要指出的是，上述适用边界存在若干限制性假设：当系统呈现非线性响应（如高功率等离子体）或空间非均匀分布时，需对正问题模型进行相应扩展或引入层析反演技术；此外，在极强损耗条件下，信号衰减可能导致信噪比不足，进而影响反演精度。

在工程实践中，应遵循以下策略以优化反演效果。首先是参数分级策略——在多参数反演中应首先识别主参数与次级参数，若次级参数可通过先验信息获得（如滤波器阶数由设计文档给出），建议将其固定以提高主参数精度。其次是充分利用先验信息——MCMC的贝叶斯框架天然支持先验信息的融入，在实际应用中应充分利用器件规格书、历史测量数据或物理约束来设定合理的先验分布。最后是建立模型验证闭环——反演结果应通过正向仿真进行验证，确保后验均值曲线与观测数据的拟合残差处于测量噪声量级。

---

## 本节小结

本节以Butterworth带通滤波器为验证对象，系统考察了所提"滑动窗口-ESPRIT-MCMC"反演框架在非介质型系统中的适用性，并从方法学层面论证了算法从"介质参数反演"向"通用系统辨识"的跃升。

在滤波器群时延建模方面，推导了Butterworth滤波器的群时延解析表达式（式5-17），并特别指出该模型**不包含空间尺度参数$d$**——这与等离子体、超材料等介质型系统形成本质区别，使得滤波器验证具有独特的方法学价值。

在仿真验证与特征提取方面，构建了包含通带纹波、插入损耗及系统底噪的工程级滤波器仿真环境。ESPRIT特征提取在整个频率范围内准确捕获了群时延曲线的钟形形态，RMSE约0.08 ns。

在MCMC三参数反演方面，成功实现了$(F_0, BW, N)$的联合反演。中心频率$F_0$反演精度最高（误差0.14%，CV = 0.29%），确认为强可观测主参数；带宽$BW$与阶数$N$的CV分别为4.42%与9.90%，属于中等至弱可观测参数。Corner Plot分析揭示了$BW$-$N$之间的负相关（$\rho = -0.42$），源于两参数对峰值高度的共同控制。

在算法普适性分析方面，通过Drude、Lorentz与Butterworth三类模型的系统性对比，论证了所提方法已超越特定物理机制的约束：算法的核心能力在于识别"群时延曲线的形状"，而非依赖任何介质传播机制。只要目标系统满足因果律约束且群时延函数具有明确的参数化形式，均可纳入本框架进行参数辨识。

综上所述，本节的验证结果将所提反演方法的应用价值提升至新的高度：它不仅是一种等离子体诊断工具，更是一种通用的**宽带系统传递函数辨识方法**，在工程应用中具有推广价值。
