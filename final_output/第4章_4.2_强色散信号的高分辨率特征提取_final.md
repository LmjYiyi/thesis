# 4.2 强色散信号的高分辨率特征提取

第4.1节从物理约束的角度论证了参数降维策略的必要性与可行性,确立了"固定碰撞频率$\nu_e$、仅反演电子密度$n_e$"的反演框架。然而,这一框架的成功实施还面临一个关键的信号处理难题:如何从色散导致的非平稳差频信号中,高精度地提取出用于反演的"频率-时延"特征数据?

第3.3节已揭示,在强色散条件下,差频信号的瞬时频率$f_D(t) = f_D' + \alpha t$随时间线性漂移,传统全频段FFT将产生严重的频谱散焦。第3.4节进一步建立了工程判据$B \cdot \eta \cdot \tau_0 \le 1$,在临界区域以外,传统方法已不可避免地失效。这意味着必须放弃"差频信号为稳态单频"的隐含假设,转而承认其非平稳本质,并设计能够追踪时变频率特性的高分辨率特征提取算法。

本节提出的技术路线基于一个核心物理洞察:**虽然差频信号在全调制周期$T_m$内呈现显著的非平稳特性,但在远短于$T_m$的局部时间窗口内,瞬时频率的变化可被近似为常数**。这种"全局非平稳、局部近似平稳"的信号特性,为时频解耦提供了天然的物理基础。通过滑动短时观测窗将宽带非平稳信号分割为一系列局部平稳片段,再利用高分辨率频率估计算法(ESPRIT)在每个窗口内精确提取瞬时差频,最终可将原本模糊的全局频谱"还原"为清晰的时频特征轨迹——这正是连接测量数据与物理模型的关键桥梁。

---

## 4.2.1 基于短时观测窗的时频解耦与局部信号线性化近似

### 从全局非平稳到局部平稳:时频解耦的物理基础

传统LFMCW测距算法失效的根本原因,在于其隐含了"差频信号为单频稳态信号"的物理假设。然而,根据第3.3.2节推导的式(3-44),色散介质中的差频信号瞬时频率$f_D(t) = f_D' + \alpha t$随时间线性漂移,斜率$\alpha$由二阶色散系数$\tau_2$主导。在整个调制周期$T_m$(典型值为50 $\mu$s至1 ms)内,该频率漂移可达数十MHz,远超FFT的频率分辨率,导致严重的频谱散焦。

然而,传统全频段FFT方法失效的更深层原因,在于其存在**参数依赖的循环逻辑死循环**。理论上,若已知差频信号的瞬时频率$f_D(t)$与调频斜率$\alpha$,可通过映射关系$f_T = f_0 + \frac{B}{T_m} \cdot \frac{f_D - f_D'}{\alpha}$将差频频率$f_D$转换为发射频率$f_T$。然而,在强色散介质(如等离子体截止频率附近)中,调频斜率$\alpha$本身是频率的强函数——因为二阶色散系数$\tau_2(\omega)$随频率剧烈变化,并非泰勒展开假设的常数。若想通过该公式反推$f_T$,必须预先知道色散参数$\alpha$,而$\alpha$正是我们待求的未知量。这在逻辑上构成了无法解开的死循环。

此外,由于$\alpha$随频率变化,整个频域的尺度发生了严重的非线性扭曲(拉伸或压缩)。这意味着全局频谱上的频率轴已经不再是线性的,直接读取峰值或展宽边缘无法对应到真实的物理频率点。此时,差频信号的频谱不仅展宽,而且发生了畸变,单一的"中心频率"或"展宽宽度"失去了明确的物理对应关系。

**滑动窗口的纠正逻辑:以时间定频率**。为了打破上述循环,必须改变观测视角:我们不需要从"模糊且扭曲的频谱"反推时间,而是直接控制时间。在时刻$t_i$截取滑动窗口,横坐标的发射频率$f_{probe}(t_i) = f_0 + K t_i$是已知且固定的(由发射机硬件决定),不受介质色散影响。在短时窗口内,介质可近似为局部平稳,此时测量得到的差频$f_{beat}$直接对应当前的群时延$\tau(t_i)$。通过这种方式,我们将一个复杂的全频段非线性反演问题,解耦为一系列局部的线性测量问题,从而构建出精确的"频率-时延"特征曲线。

从方法论的高度审视,滑动窗口法的本质是将原本需要全频段参数$\alpha$才能解耦的非线性频域映射问题,降维为一系列**不需要先验知识**的局部线性时域测量问题。这不仅规避了循环逻辑的陷阱,更将复杂的色散参数估计问题转化为了成熟的瞬时频率追踪问题——后者已有大量高分辨率算法(如ESPRIT)可供调用。

这一物理洞察构成了时频解耦策略的理论基础:通过用短时观测窗"切割"全局非平稳信号,将复杂的时频分析问题分解为一系列简单的局部频率估计问题。每个窗口内提取的瞬时差频$f_{beat}(t_i)$,对应于该时刻探测频率$f_{probe}(t_i) = f_0 + K t_i$处的局部群时延$\tau_g(t_i)$,由此建立起离散的"频率-时延"特征点集。

### 短时窗口参数的物理约束与优化准则

短时观测窗口的时长$T_w$需要在两个相互矛盾的约束之间取得平衡。一方面,窗口不能过长,否则窗内频率漂移$\delta f = |\alpha| T_w$过大,破坏局部平稳假设。另一方面,窗口也不能过短,否则可用于频率估计的采样点数$N_w = T_w \cdot f_s'$不足,导致估计方差急剧上升。

为建立定量的参数选择准则,设定窗口时长$T_w$应满足窗内频率漂移不超过目标频率分辨率的某一比例$\beta$(通常取$\beta \le 0.1$):

$$\delta f = |\alpha| T_w \le \beta \cdot \Delta f_{target} \tag{4-16}$$

其中$\Delta f_{target}$为期望的频率估计精度。由式(3-42),$\alpha$在强色散区的典型量级约为$10^6 \sim 10^7$ Hz/s。若要求频率估计精度达到$\Delta f_{target} = 10$ kHz,则窗口时长上限为:

$$T_w \le \frac{\beta \cdot \Delta f_{target}}{|\alpha|} = \frac{0.1 \times 10^4}{10^6} = 1 \text{ ms} \tag{4-17}$$

该计算表明,在典型Ka波段参数下,10-20 $\mu$s量级的窗口时长可有效保证局部平稳性。然而,窗口时长还受限于频率估计算法的性能需求。虽然经典谱估计理论通常建议观测时长包含20个以上信号周期以抑制噪声,但基于子空间的ESPRIT算法在短快拍数下仍具有良好的参数估计能力。

考虑到混频后差频信号的中心频率约为$f_D' \approx K \tau_0 \sim 200$ kHz(对应时延约4 ns,调频斜率$K = 64 \times 10^{12}$ Hz/s),信号周期约为5 $\mu$s。为确保算法稳定性,物理上至少需要包含**3个完整周期**,窗口时长下限约为15 $\mu$s。综合上述双向约束及边缘效应处理,本文选取$T_w = 12$ $\mu$s作为仿真实验参数,该值在局部平稳性与估计精度之间取得了较优的平衡点。需要指出的是,上述"3个周期"为保守经验估计;本文采用的TLS-ESPRIT子空间算法在短快拍条件下仍具有良好的频率估计性能,仿真结果表明在$T_w = 12$ $\mu$s时仍可获得稳定、无偏的瞬时差频估计,因此本文在局部平稳性与时间分辨率之间选择了略偏短的窗口配置。

### 滑动窗口的时频映射机制

在确定窗口时长$T_w$后,需要设计窗口的滑动策略以实现对全调制周期的连续覆盖。设窗口滑动步长为$T_{step}$,则在$[0, T_m]$范围内可划分出$N_w$个观测窗口。以本文仿真参数为例:$T_m = 50$ $\mu$s,$T_w = 12$ $\mu$s,采用90%重叠率即$T_{step} = 1.2$ $\mu$s,则理论窗口数量约为:

$$N_w = \left\lfloor \frac{T_m - T_w}{T_{step}} \right\rfloor + 1 \approx 32$$

第$i$个窗口的中心时刻$t_i$对应的探测频率(即发射信号的瞬时频率)为:

$$f_{probe}(t_i) = f_0 + K \cdot t_i \tag{4-18}$$

该映射关系的物理意义极为关键:$f_{probe}(t_i)$完全由雷达系统参数决定,不依赖于任何待测介质的物理量。换言之,特征点的"横坐标"——探测频率轴——是先验已知的、刚性的系统参数,这为后续构建精确的观测模型提供了坚实的基础。

在第$i$个窗口内,利用高分辨率频率估计算法(如ESPRIT)提取局部差频$f_{beat,i}$。根据LFMCW的混频原理,该差频与瞬时群时延$\tau_g(t_i)$满足线性关系:

$$f_{beat,i} = K \cdot \tau_g(t_i) \tag{4-19}$$

由此可直接计算得到测量时延:

$$\tau_{meas,i} = \frac{f_{beat,i}}{K} \tag{4-20}$$

需要强调的是,该测量时延$\tau_{meas,i}$是基于LFMCW混频原理直接获得的"表观时延",它包含了由一阶色散系数$\tau_1$引入的系统性偏移,并非等离子体的真实群时延$\tau_g(f_{probe,i})$。这种系统误差的存在正是后续(第4.3节)需要构建包含误差修正项的理论模型进行反向拟合的根本原因。

将式(4-18)至(4-20)联立,每个滑动窗口输出一个特征点$(f_{probe,i}, \tau_{meas,i})$。全部$N_w$个窗口形成的特征点集$\mathcal{D} = \{(f_{probe,i}, \tau_{meas,i})\}_{i=1}^{N_w}$,即构成了"频率-时延"特征轨迹的离散采样。该轨迹的形态由等离子体的色散特性唯一决定——在第3.1节建立的Drude模型框架下,理论时延曲线$\tau_g(f; n_e)$是电子密度$n_e$的强函数,曲线的"拐点"位置(渐近发散处)直接对应截止频率$f_p$,而曲率特征则反映了非线性度$\eta$的空间分布。

如图4-4(a)所示,传统全频段FFT处理方法隐含差频在整个调频周期内保持恒定的假设。在强色散条件下,等离子体的群时延随探测频率显著变化,从而导致瞬时差频呈现明显的频率依赖性。该非平稳特性在全时域FFT处理中被不可避免地平均,最终表现为一宽频散焦区域,使得差频与探测频率之间不存在唯一、可解析的映射关系,传统方法因此失效。

相比之下,图4-4(b)展示了本文提出的滑动窗口时频解耦方法的处理结果。该方法通过在短时窗口内对信号进行局部平稳近似,将全局非平稳问题转化为一系列局部可解析的子问题,从而成功恢复了差频随探测频率变化的连续轨迹。图中蓝色虚线表示基于Drude等离子体色散模型与LFMCW雷达原理前向计算得到的理论差频轨迹(Ground Truth),橙色散点为滑动窗口方法提取的瞬时差频特征。需要说明的是,图中理论轨迹的计算采用了基于Drude模型的一阶工程近似群时延表达式$\tau_g \approx (d/c) \cdot \text{Re}(1/\sqrt{\varepsilon_r})$,用以体现强色散区差频随频率变化的主要非线性趋势;该近似在本文关注的参数区间内与严格群时延定义$\tau_g = -d\phi/d\omega$具有一致的定性行为。二者高度一致,表明该方法能够在强色散条件下准确追踪差频的非线性演化规律,验证了时频解耦策略的物理合理性与有效性。这些离散特征点将作为后续参数反演的观测数据,取代传统方法中模糊的全局频谱峰值。

图4-4的仿真参数设置如下:等离子体截止频率$f_p = 33$ GHz,碰撞频率$\nu_e = 1.5$ GHz,等离子体厚度$d = 0.15$ m;LFMCW雷达扫频范围34.2-37.4 GHz(带宽$B = 3.2$ GHz),扫频周期$T_m = 50$ $\mu$s,对应调频斜率$K = 64 \times 10^{12}$ Hz/s。滑动窗口参数:窗口时长$T_w = 12$ $\mu$s,窗口步长$T_{step} = 1.2$ $\mu$s(对应90%重叠率),边缘保护区间$[0.05T_m, 0.95T_m]$。在该配置下,有效窗口数约为32个,覆盖探测频率范围约34.4-37.2 GHz。

### 边缘效应的物理处理

值得注意的是,在调制周期的首尾边缘区域(约$0.05 T_m$范围内),LFMCW信号存在过渡瞬态,差频信号的稳定性较差。这种边缘效应在色散条件下会被进一步放大,表现为ESPRIT估计的频率出现异常跳变。因此,在特征提取过程中,应设置保护区间,仅对$t \in [0.05 T_m, 0.95 T_m]$范围内的窗口进行处理,舍弃边缘区域的不可靠数据。此外,为保证反演的稳健性,本文采用了**高重叠率滑动窗口**策略:窗口步长设为$T_{step} = T_w/10$,对应90%的重叠率。这种高密度采样不仅增加了特征点的数量,更有效平滑了窗口边缘处的估计突变,为后续参数反演提供了统计意义上更加鲁棒的观测数据。

此外,当探测频率接近截止频率$f_p$时,信号幅度急剧衰减(见第4.1.1节图4-1(b)右轴的幅度曲线),信噪比严重恶化。在这些低信噪比区域,ESPRIT算法的频率估计方差显著增大,甚至可能完全失效。为了量化各特征点的可靠性,本文在每个窗口内同步提取信号的均方根(RMS)幅度$A_i$作为置信度权重:

$$A_i = \sqrt{\frac{1}{N_{sam}}\sum_{n=1}^{N_{sam}}|s_D(t_{i,n})|^2} \tag{4-21}$$

其中$N_{sam}$为窗口内的采样点数(注意区分$N_w$为总窗口数)。该幅度信息将在后续构建加权似然函数时(见4.3节)发挥关键作用:高幅度(高信噪比)区域的特征点被赋予较大权重,主导反演过程;而低幅度区域的特征点权重被自动降低,避免噪声主导的错误数据污染反演结果。这种基于物理机制的自适应加权策略,本质上利用了第4.1.1节揭示的"幅度对$\nu_e$敏感、时延对$n_e$敏感"的解耦特性——虽然未显式反演碰撞频率$\nu_e$,却巧妙地将其物理效应融入了算法的鲁棒性设计中。

---

## 4.2.2 多径干扰下的信源数估计(MDL准则)与子空间净化

### 多径效应的物理来源与干扰特征

在实际的微波透射诊断系统中,除了穿过等离子体介质的直达路径外,电磁波还会在系统组件(天线馈口、波导壁、介质界面)发生多次反射,形成多径传播效应。这些反射波与直达波在接收端叠加,导致混频后的差频信号不再是单一频率成分,而是包含多个离散频率分量的复合信号。

从信号模型的角度,设直达波对应的差频为$f_D^{(0)}$,第$k$条反射路径对应的差频为$f_D^{(k)}$,则窗口内的差频信号可表示为:

$$s_D(t) = \sum_{k=0}^{K-1} A_k \exp\{j[2\pi f_D^{(k)} t + \phi_k]\} + n(t) \tag{4-22}$$

其中$A_k$和$\phi_k$分别为第$k$条路径的幅度和初相,$n(t)$为加性高斯白噪声,$K$为总信源数(包含直达波和反射波)。由于反射路径长于直达路径,反射波经历的群时延更大,对应的差频$f_D^{(k)} > f_D^{(0)}$($k \ge 1$)。

若直接对式(4-22)描述的多分量信号进行FFT分析,频谱将呈现多峰结构,各峰对应不同路径的贡献。在峰值间距较大(即路径时延差显著)时,可通过峰值检测直接分离;然而,当路径时延差较小或信噪比较低时,频谱峰值发生重叠或模糊,传统方法难以准确提取直达波分量。更严重的是,若误将反射波峰值当作直达波处理,将导致系统性的时延高估,反演得到的电子密度严重偏高。

### 子空间方法的引入:信号与噪声的正交分解

为了在多径干扰下准确提取直达波频率,本文引入基于子空间分解的高分辨率频率估计方法。该类方法的核心思想是:利用信号协方差矩阵的特征结构,将观测空间正交分解为信号子空间与噪声子空间,从而实现信号分量与噪声背景的有效分离。

设窗口内采样点数为$N_w$,将差频信号$\{s_D(n)\}_{n=0}^{N_w-1}$按Hankel结构排列为数据矩阵。选取子空间维度$L$(通常取$L = N_w/2$),构造$L \times M$维Hankel矩阵(其中$M = N_w - L + 1$)。取$L = N_w/2$可使Hankel矩阵接近方阵,从而在子空间维度与快拍数之间取得最优平衡,既保证了足够的频率分辨率,又提供了充分的统计样本以稳定协方差估计:

$$\mathbf{X} = \begin{bmatrix}
s_D(0) & s_D(1) & \cdots & s_D(M-1) \\
s_D(1) & s_D(2) & \cdots & s_D(M) \\
\vdots & \vdots & \ddots & \vdots \\
s_D(L-1) & s_D(L) & \cdots & s_D(N_w-1)
\end{bmatrix} \tag{4-23}$$

计算数据矩阵的协方差估计:

$$\mathbf{R}_f = \frac{1}{M}\mathbf{X}\mathbf{X}^H \tag{4-24}$$

为提高估计精度,进一步利用信号的共轭对称性进行前后向平均(Forward-Backward Averaging):

$$\mathbf{R}_x = \frac{1}{2}(\mathbf{R}_f + \mathbf{J}\mathbf{R}_f^*\mathbf{J}) \tag{4-25}$$

其中$\mathbf{J}$为$L \times L$的反对角单位矩阵。前后向平均有效利用了实信号的共轭对称特性,使协方差矩阵的特征值分布更加稳定,同时将等效快拍数加倍,提升了弱信号检测能力。

对$\mathbf{R}_x$进行特征值分解:

$$\mathbf{R}_x = \mathbf{U}\mathbf{\Lambda}\mathbf{U}^H \tag{4-26}$$

其中$\mathbf{\Lambda} = \text{diag}(\lambda_1, \lambda_2, \cdots, \lambda_L)$为特征值对角矩阵(按降序排列),$\mathbf{U} = [\mathbf{u}_1, \mathbf{u}_2, \cdots, \mathbf{u}_L]$为对应的特征向量矩阵。

在理想无噪声条件下,若信号包含$K$个频率分量,则协方差矩阵的秩为$K$,仅有$K$个非零特征值,其余$L-K$个特征值严格为零。在实际有噪声环境中,特征值谱呈现典型的"阶梯+平台"结构:前$K$个特征值(信号特征值)显著大于噪声功率$\sigma^2$,后$L-K$个特征值(噪声特征值)聚集在$\sigma^2$附近形成"噪声平台"。这种特征值谱的双模态分布,为信号子空间与噪声子空间的分离提供了天然的判别依据。

### MDL准则:基于信息论的信源数估计

子空间方法的有效性高度依赖于信源数$K$的准确估计。若$K$估计过小,部分弱反射波分量被误判为噪声而丢失;若$K$估计过大,噪声分量被误判为信号,导致后续频率估计出现伪峰。因此,在执行ESPRIT算法之前,必须首先解决信源数估计这一关键前置问题。

本文采用基于信息论的**最小描述长度(Minimum Description Length, MDL)**准则进行信源数估计。MDL准则的核心思想是:在模型复杂度与数据拟合度之间寻求最优平衡——过于简单的模型(小$K$)无法充分描述数据特征,而过于复杂的模型(大$K$)则会过拟合噪声。

对于给定的候选信源数$k$($0 \le k \le L-1$),MDL代价函数定义为:

$$\text{MDL}(k) = -\ln\left(\frac{\prod_{j=k+1}^{L}\lambda_j^{\frac{1}{L-k}}}{\frac{1}{L-k}\sum_{j=k+1}^{L}\lambda_j}\right)^{(L-k)M} + \frac{1}{2}k(2L-k)\ln M \tag{4-27}$$

其中,$L$为子空间维度(Hankel矩阵的行数,对应窗口的有效长度),$M = N_w - L + 1$为快拍数(Hankel矩阵的列数),$\lambda_j$为协方差矩阵的特征值(按降序排列)。需要说明的是,本文采用的符号约定($L$为子空间维度,$M$为快拍数)遵循信号处理领域的通用习惯,部分文献中可能采用相反的约定,但不影响算法本质。式(4-27)包含两个物理意义明确的部分。第一项为对数似然函数,衡量$K=k$假设下数据的拟合优度:分子为噪声特征值$\{\lambda_{k+1}, \cdots, \lambda_L\}$的几何平均,分母为算术平均。在理想情况下(噪声特征值完全相等),几何平均等于算术平均,该比值为1,对数为0;当噪声特征值存在离散(说明仍有信号分量被误判为噪声)时,几何平均小于算术平均,该项增大,惩罚欠拟合。第二项为模型复杂度惩罚项,与自由参数个数$k(2L-k)$成正比,惩罚过拟合。

**窗口级自适应MDL判决机制**。需要进一步指出的是,本文采用的MDL准则并非在全观测时域内执行一次性的全局信源数判决,而是嵌入于滑动时频处理框架中的窗口级自适应判决机制。具体而言,对于每一个时频分析窗口,均独立构造对应的Hankel数据矩阵并估计协方差矩阵,其特征值谱随时间动态变化。MDL代价函数在每一个窗口内重新计算,并据此获得该窗口对应的最优信源数估计$\hat{K}_i$。这种"逐窗估计—逐窗更新"的处理方式,使得算法能够自适应跟踪差频信号在强色散和多径条件下的非平稳演化特性。当反射路径随时间出现或消失、信噪比发生波动时,信号子空间维度可随窗口自动调整,而无需依赖固定阈值或人工经验设定。因此,本文中的MDL准则不仅用于多径条件下的信源数估计,更作为一种窗口级自适应子空间维度选择器,为后续ESPRIT频率估计与直达波提取提供了稳定且物理一致的子空间支撑。

信源数的最优估计$\hat{K}$通过最小化MDL代价函数获得:

$$\hat{K} = \arg\min_{0 \le k \le L-1} \text{MDL}(k) \tag{4-28}$$

**值得强调的是,该算法具有显著的数据驱动(Data-driven)自适应特性**。对于每一个滑动观测窗,算法均依据当前协方差矩阵的特征值分布动态计算代价函数,自动锁定信号子空间的最优维度,无需人工设定固定的判决阈值。这种自适应性使算法能够灵活应对不同信噪比环境和多径条件,而非依赖经验性的静态规则。

在此基础上,为进一步提升工程实现的鲁棒性,本文引入了基于物理先验的"软约束"机制:

$$K_{final} = \max(1, \min(\hat{K}, K_{max})) \tag{4-29}$$

其中$K_{max} = 3$,对应直达波加两条主要反射路径的典型场景。该约束并未破坏MDL的自适应性,而是划定了合理的物理搜索边界——在实际透射诊断系统中,超过3条有效传播路径的情况极为罕见。下限强制为1,确保至少提取一个频率分量。这种"软约束"策略有效规避了极端低信噪比下算法可能出现的过估计(Over-estimation)风险,同时保留了MDL对数据特征的敏感响应。

图4-5通过数值仿真验证了单个分析窗口内MDL准则的判决特性,该特性在本文的滑动窗口框架中被逐窗调用,从而构成整体的窗口级自适应信源数估计机制。如图4-5(a)所示,在$K_{true} = 2$的仿真条件下,MDL代价函数在$k=2$处呈现出清晰、陡峭的**全局极小值(Global Minimum)**。在不同信噪比条件(10 dB、20 dB、30 dB)下,该极小值位置始终稳定在$k=2$,并未发生漂移,证明了算法对噪声具有较强的免疫力。三条曲线的"V字形"谷底越尖锐,说明对真实信源数的区分度越高。

图4-5(b)进一步对比了MDL与AIC(赤池信息准则)在低信噪比下的表现差异。可以观察到:在$k \le K_{true}$的欠拟合区域,两种准则的代价函数走势相近,均呈急剧下降趋势;然而在$k > K_{true}$的过拟合区域(即噪声子空间),二者表现出显著差异。AIC准则的代价函数曲线(橙色虚线)在$k > 2$后上升相对平缓,这是因为AIC的惩罚项为$2k$,对模型复杂度的惩罚力度较弱,容易将噪声误判为信号分量;而MDL准则的曲线(蓝色实线)在$k > 2$后迅速陡峭上升,表现出更强的**过拟合抑制能力**——这源于MDL的惩罚项$\frac{1}{2}k\ln M$随快拍数$M$对数增长,在典型参数下惩罚力度约为AIC的2-3倍。因此,在信噪比波动剧烈的等离子体诊断环境中,MDL准则相比AIC具有更高的安全裕度,更适合作为信源数估计的判据。

### 子空间净化与直达波提取策略

在获得信源数估计$\hat{K}$后,可将协方差矩阵的特征向量按特征值大小分为两组:

$$\mathbf{U}_s = [\mathbf{u}_1, \mathbf{u}_2, \cdots, \mathbf{u}_{\hat{K}}] \quad \text{(信号子空间)} \tag{4-30}$$

$$\mathbf{U}_n = [\mathbf{u}_{\hat{K}+1}, \cdots, \mathbf{u}_L] \quad \text{(噪声子空间)} \tag{4-31}$$

信号子空间$\mathbf{U}_s$张成的空间包含了全部$\hat{K}$个频率分量的信息,而噪声子空间$\mathbf{U}_n$与信号正交,仅包含白噪声的贡献。这种正交分解实现了"子空间净化"——通过将观测数据投影到信号子空间,有效滤除了噪声子空间的干扰。

然而,从多径干扰的角度看,子空间净化只是完成了"信号vs噪声"的分离,尚未解决"直达波vs反射波"的区分问题。后续的ESPRIT算法将基于信号子空间$\mathbf{U}_s$估计出全部$\hat{K}$个频率分量$\{f_D^{(k)}\}_{k=1}^{\hat{K}}$。为了从中准确识别直达波,本文依据多径传播的基本物理规律构建判据。从几何光学的角度分析,直达路径是发射端至接收端的最短光程,因而其群时延$\tau_g^{(0)}$必然小于任何经历额外反射的路径;相应地,由$f_D^{(k)} = K \tau_g^{(k)}$可知,直达波对应的差频$f_D^{(0)}$在所有分量中居于最低值。与此同时,直达波未经反射界面的能量损耗,其幅度$A_0$通常也是各分量中最大的。在绝大多数实际诊断场景中,上述"最小时延"与"最大幅度"两条准则给出一致的判定结果,这为直达波的自动识别提供了可靠的物理依据。基于此,本文采用的提取策略是:从$\hat{K}$个ESPRIT估计结果中选取频率最小且能量显著的分量作为直达波的差频$f_{beat,i}$。若出现冲突(如某反射路径因聚焦效应幅度增强),则优先采用最小时延原则。该原则在透射实验中具有极高的物理鲁棒性——因为物理上不存在比光速更快的传播路径,直达波的时延必然是所有可能路径中的理论下界,这一约束是不可违反的基本物理定律。据此,直达波频率的提取策略可形式化为:

$$f_{D,direct} = \min\{f_D^{(k)} : f_D^{(k)} > f_{min} \text{ 且 } f_D^{(k)} < f_{max}\} \tag{4-32}$$

其中$f_{min}$和$f_{max}$为基于物理约束设定的频率有效范围(典型值$f_{min} = 50$ kHz,$f_{max} = 10$ MHz),用于剔除明显不合理的异常估计值。

---

## 4.2.3 基于TLS-ESPRIT的"频率-时延"特征轨迹高精度重构

### ESPRIT算法的旋转不变性原理

在完成信源数估计与子空间分离后,下一步是从信号子空间中精确提取各频率分量。本文采用**旋转不变子空间技术(Estimation of Signal Parameters via Rotational Invariance Techniques, ESPRIT)**实现高分辨率频率估计。相比于基于频谱搜索的MUSIC算法,ESPRIT具有无需谱峰搜索、计算效率高、参数估计精度高等显著优势。

ESPRIT算法的核心思想基于信号子空间的**旋转不变性(Shift Invariance)**。对于式(4-23)定义的Hankel数据矩阵$\mathbf{X}$,考察其上下两个子矩阵:

$$\mathbf{X}_1 = \mathbf{X}(1:L-1, :) \tag{4-33}$$

$$\mathbf{X}_2 = \mathbf{X}(2:L, :) \tag{4-34}$$

其中$\mathbf{X}_1$为$\mathbf{X}$删除最后一行所得,$\mathbf{X}_2$为删除第一行所得。由于Hankel矩阵的特殊结构,$\mathbf{X}_2$相当于$\mathbf{X}_1$在时间轴上平移一个采样间隔$T_s = 1/f_s'$。

对于包含$K$个复指数信号的模型,可以证明$\mathbf{X}_1$与$\mathbf{X}_2$的列空间(即信号子空间)满足旋转不变关系:

$$\mathbf{X}_2 = \mathbf{X}_1 \mathbf{\Phi} \tag{4-35}$$

其中$\mathbf{\Phi} = \text{diag}(e^{j2\pi f_D^{(1)}/f_s'}, \cdots, e^{j2\pi f_D^{(K)}/f_s'})$为对角旋转矩阵,其对角元素直接包含了待估计的频率信息。式(4-35)揭示了ESPRIT算法的物理本质:**单采样间隔的时间平移在信号子空间中表现为旋转变换,旋转角度由信号频率唯一决定**。

### TLS-ESPRIT的最小二乘实现

在实际有噪声环境中,式(4-35)的旋转不变关系仅近似成立。为了在最小均方误差意义下估计旋转矩阵$\mathbf{\Phi}$,本文采用**全最小二乘ESPRIT(Total Least Squares ESPRIT, TLS-ESPRIT)**算法。

首先,从协方差矩阵的信号子空间$\mathbf{U}_s$(式4-30)中提取对应的上下子矩阵:

$$\mathbf{U}_{s1} = \mathbf{U}_s(1:L-1, :) \tag{4-36}$$

$$\mathbf{U}_{s2} = \mathbf{U}_s(2:L, :) \tag{4-37}$$

TLS-ESPRIT通过求解以下优化问题估计旋转矩阵:

$$\mathbf{\Psi} = (\mathbf{U}_{s1}^H\mathbf{U}_{s1})^{-1}\mathbf{U}_{s1}^H\mathbf{U}_{s2} \tag{4-38}$$

式(4-38)的物理意义是:在最小二乘意义下,寻找使$\mathbf{U}_{s2} \approx \mathbf{U}_{s1}\mathbf{\Psi}$成立的最优旋转矩阵。与标准最小二乘ESPRIT(LS-ESPRIT)仅考虑$\mathbf{U}_{s2}$的观测误差不同,全最小二乘方法承认$\mathbf{U}_{s1}$和$\mathbf{U}_{s2}$均受噪声污染,通过对两侧同时进行噪声修正,可在低信噪比条件下获得更接近真实旋转矩阵的估计,从而显著提升频率估计的精度与鲁棒性。

对旋转矩阵$\mathbf{\Psi}$进行特征值分解:

$$\mathbf{\Psi} = \mathbf{V}\mathbf{D}\mathbf{V}^{-1} \tag{4-39}$$

其中$\mathbf{D} = \text{diag}(z_1, z_2, \cdots, z_K)$为特征值对角矩阵。由于$\mathbf{\Psi}$与$\mathbf{\Phi}$相似,其特征值$\{z_k\}$与$\{e^{j2\pi f_D^{(k)}/f_s'}\}$一一对应。因此,各频率分量可通过特征值的相位角直接提取:

$$f_D^{(k)} = \frac{f_s'}{2\pi}\angle z_k \tag{4-40}$$

其中$\angle z_k$表示复数$z_k$的相位角(取值范围$[-\pi, \pi)$),$f_s'$为降采样后的等效采样率(为降低计算复杂度,实际工程中通常对原始高速采样信号进行抽取处理)。式(4-40)是ESPRIT算法的核心公式,它将频率估计问题转化为矩阵特征值问题,避免了传统FFT的栅栏效应,可实现超分辨率的频率估计。

### 特征轨迹的高精度重构与数据融合

将上述算法应用于每个滑动窗口,即可获得一系列离散的特征点$(f_{probe,i}, \tau_{meas,i}, A_i)$,其中$f_{probe,i}$为探测频率(式4-18),$\tau_{meas,i}$为测量时延(式4-20),$A_i$为幅度权重(式4-21)。全部$N_w$个特征点构成的数据集:

$$\mathcal{D} = \{(f_{probe,i}, \tau_{meas,i}, A_i)\}_{i=1}^{N_w} \tag{4-41}$$

即为"频率-时延"特征轨迹的离散表示。从物理意义上分析,该数据集中探测频率$f_{probe,i}$完全由雷达系统参数($f_0, K, t_i$)决定,不受介质特性影响,为反演提供了刚性的自变量基准;测量时延$\tau_{meas,i}$则通过式(4-19)与群时延$\tau_g(f_{probe,i})$建立联系,后者由Drude模型(式3-14)给出,是电子密度$n_e$的强函数;幅度$A_i$反映了该频点的信噪比水平,在高衰减区(接近截止频率)自动降低,在透射窗口内保持较高值,为后续加权反演提供物理依据。

图4-6展示了典型工况($f_p = 33$ GHz, $d = 0.15$ m)下重构的特征轨迹,并与传统FFT方法进行了直观对比。如图所示,传统FFT提取的时延曲线(灰色虚线)因栅栏效应呈现显著的阶梯状跳变,且在强色散区(接近截止频率$f_p$处)因频谱散焦导致估计值完全发散;而ESPRIT提取的特征点(蓝色散点)则精准地描绘了理论Drude曲线(红色实线)的精细结构,甚至连纳秒级的非线性弯曲都清晰可辨。尤其值得注意的是,在接近截止频率的高非线性区(34-35 GHz),FFT方法的估计误差已超过100%而完全失去参考价值,ESPRIT仍能稳定追踪时延曲线的陡峭上升趋势,其估计精度比FFT提升了1-2个数量级。这种对比鲜明地展现了子空间方法在强色散条件下的显著优势。

需要指出的是,传统FFT并非仅精度不足,其方法论前提在强色散条件下即不成立:全局频谱分析隐含差频在窗内恒定,而差频实为探测频率的强函数,非平稳过程被平均为宽频散焦,从而破坏"频率-时延"的一一映射。相较之下,滑动窗口TLS-ESPRIT通过局部平稳近似实现时频解耦,结合子空间分解与MDL自适应估计抑制多径与噪声,并利用旋转不变性直接提取频率参数,在强色散高非线性区仍能稳定收敛。数值仿真表明,ESPRIT重构轨迹与理论Drude曲线高度一致,RMSE为0.0037 ns、最大误差0.0099 ns(有效特征点数32),而FFT平均误差为0.1952 ns且在截止频率附近失去物理可解释性。因此,FFT仅能作为方法论反例,基于MDL+TLS-ESPRIT的重构构成强色散条件下可靠的频率-时延联合估计框架。

此外,图中散点的颜色深浅对应幅度权重$A_i$的大小:在远离截止频率的透射窗口内(36-37 GHz),散点颜色较深(权重高);而在接近截止频率处,散点颜色变浅(权重低),直观反映了信号幅度随频率的衰减特征。这种可视化表示为后续理解加权似然函数(4.3节)的物理机制提供了直观参照。


---

## 本节小结

本节提出了基于"滑动窗口-MDL-ESPRIT"的高分辨率特征提取算法框架。在时频解耦层面,基于"全局非平稳、局部近似平稳"的物理洞察,建立了窗口时长的双向约束准则(式4-16),并提出幅度权重$A_i$作为置信度评估机制。在多径抑制层面,引入子空间分解与MDL准则实现窗口级自适应信源数估计,结合"最小时延原则"可靠提取直达波分量。在频率估计层面,TLS-ESPRIT利用旋转不变性实现超分辨率估计,仿真表明其精度较FFT提升1-2个数量级。最终构建的特征数据集$\mathcal{D} = \{(f_{probe,i}, \tau_{meas,i}, A_i)\}$将传统方法眼中的"频谱散焦"还原为携带介质信息的时频特征轨迹,为第4.3节的贝叶斯参数反演提供了高质量的观测输入。
