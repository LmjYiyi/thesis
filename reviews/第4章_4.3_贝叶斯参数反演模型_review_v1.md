# 评审报告：第4章 4.3 基于Metropolis-Hastings的贝叶斯参数反演模型

**评审时间**：2026-01-22
**原稿版本**：v1
**评审轮次**：第1轮

---

## Step 1: 总体评级与诊断

**【评级】A级（良好，需微调）**

**【核心问题】**
1. 4.3.2节算法流程采用"步骤1/2/3/4/5/6"的列表式写作，缺乏学术流体感
2. 4.3.3节可观测性分析流程使用"第一步/第二步/第三步/第四步"格式
3. 缺少图表融合，Corner Plot和迹线图仅被概念性描述，未实际引用图4-7、图4-8

---

## Step 2: 逐点审查 (Critique)

### 维度1：去AI化

**问题位置**：4.3.2节"Metropolis-Hastings算法的实现框架"
- **具体问题**：使用"**步骤1（初始化）**"、"**步骤2（提议新状态）**"等列表式写作，共6个步骤，每步以加粗标题开头，呈现明显的模块化拼接痕迹
- **修改建议**：将6个步骤融合为2-3个连贯段落，用逻辑连接词串联

**问题位置**：4.3.3节"可观测性判据的工程应用"
- **具体问题**：使用"**第一步**"、"**第二步**"、"**第三步**"、"**第四步**"格式
- **修改建议**：改为流体感段落，用"首先...随后...进一步...最终"等连接词

**问题位置**：本节小结
- **具体问题**：三个要点使用加粗标题，呈列表感
- **修改建议**：改为三个独立段落，开头不加粗

### 维度2：数理交融

- **评价**：整体良好，公式与物理意义有较好融合
- **轻微问题**：4.3.1节"理论时延模型的数值实现"中的4个公式(4-46~4-49)可进一步精简，部分公式可合并

### 维度3：符号统一性

- **评价**：符号使用一致，与前文及公式模板保持统一
- **无需修改**

### 维度4：术语严谨性

- **问题**：第19行"极为深刻"略显文学化
- **修改建议**："式(4-42)的物理意义极为深刻" → "式(4-42)表明"

- **评价**：无代码行号引用问题

### 维度5：数据一致性

- **评价**：参数与代码一致
  - $N_{samples} = 10000$ ✓
  - $N_{burn} = 2000$ ✓  
  - $\sigma_0 = 0.1$ ns ✓
  - $n_e \in [10^{18}, 10^{20}]$ m$^{-3}$ ✓
  - $\nu_e \in [0.1, 5]$ GHz ✓
  - 提议步长2%/5% ✓

### 维度6：图文融合

**问题位置**：4.3.3节
- **问题类型**：Corner Plot和迹线图仅在概念层面描述，未具体引用图编号（如图4-7、图4-8）
- **修改建议**：增加图4-7（MCMC迹线图）和图4-8（Corner Plot）的具体引用和分析

### 维度7：图表建议

#### 建议图表 4-7：MCMC采样迹线图

**图表类型**：双面板迹线图

**可视化目的**：
- 展示MCMC链的收敛过程
- 对比$n_e$（快速收敛）与$\nu_e$（持续漫游）的迹线差异
- 直观预示参数可观测性的本质区别

**图表设计建议**：
- **子图(a)**：$n_e$迹线，横轴为迭代次数，纵轴为$n_e$值，标注预烧期分界线和真值参考线
- **子图(b)**：$\nu_e$迹线，同上，展示在先验范围内大幅游走的特征

**融入正文的位置**：
- 放在4.3.3节"Corner Plot"小节之前
- 引导语："为直观展示上述分析框架，图4-7给出了典型仿真条件下MCMC采样的迹线图..."

**参考代码**：
- 基于`LM_MCMC.m`第585-620行的Figure 11绘图逻辑

#### 建议图表 4-8：参数联合后验分布Corner Plot

**图表类型**：2×2 Corner Plot矩阵

**可视化目的**：
- 直观对比$n_e$的"尖峰"后验与$\nu_e$的"平坦"后验
- 展示联合分布的"纵向长条"结构（$n_e$可观测、$\nu_e$不可观测）
- 为参数降维策略提供统计学实证

**图表设计建议**：
- **主对角线**：$n_e$和$\nu_e$的边缘后验直方图
- **左下角**：联合后验散点图，标注真值位置（红色十字）
- **右上角**：相关系数$\rho$
- **关键标注**：95%置信区间边界（黑色虚线）

**融入正文的位置**：
- 放在迹线图分析之后
- 引导语："图4-8进一步以Corner Plot的形式展示了参数的联合后验结构..."

**参考代码**：
- 基于`LM_MCMC.m`第624-657行的Figure 12绘图逻辑

---

## Step 3: 导师改写 (Rewrite)

### 原文（问题版本）

> 算法的具体流程如下：
> 
> **步骤1（初始化）**：从先验分布均匀采样初始状态$\mathbf{\theta}^{(0)}$，计算初始对数似然$\ln\mathcal{L}(\mathbf{\theta}^{(0)})$。该初始化策略彻底摆脱了传统优化方法对人工初值猜测的依赖——即便初始点远离真值，马尔可夫链仍能通过随机游走逐步逼近高概率区域。
> 
> **步骤2（提议新状态）**：基于当前状态$\mathbf{\theta}^{(t)}$，通过对称高斯随机游走生成候选状态：
> 
> $$\mathbf{\theta}' = \mathbf{\theta}^{(t)} + \boldsymbol{\epsilon}, \quad \boldsymbol{\epsilon} \sim \mathcal{N}(\mathbf{0}, \boldsymbol{\Sigma}_{prop}) \tag{4-52}$$
> 
> **步骤3（先验约束检查）**：若候选状态$\mathbf{\theta}'$超出先验边界，直接拒绝该提议...
> 
> **步骤4（计算接受概率）**：若候选状态在先验域内，计算Metropolis接受概率：
> 
> $$\alpha = \min\left(1, ...\right) \tag{4-53}$$
> 
> **步骤5（接受或拒绝）**：生成均匀随机数$u \sim U(0,1)$...
> 
> **步骤6（迭代循环）**：重复步骤2-5共$N_{samples}$次...

### 导师改写

> 算法的实现从初始化开始：从先验分布均匀采样初始状态$\mathbf{\theta}^{(0)}$并计算初始对数似然$\ln\mathcal{L}(\mathbf{\theta}^{(0)})$，该策略彻底摆脱了传统优化方法对人工初值猜测的依赖。随后进入迭代循环，基于当前状态$\mathbf{\theta}^{(t)}$通过对称高斯随机游走生成候选状态：
> 
> $$\mathbf{\theta}' = \mathbf{\theta}^{(t)} + \boldsymbol{\epsilon}, \quad \boldsymbol{\epsilon} \sim \mathcal{N}(\mathbf{0}, \boldsymbol{\Sigma}_{prop}) \tag{4-50}$$
> 
> 其中$\boldsymbol{\Sigma}_{prop} = \text{diag}(\sigma_{n_e}^2, \sigma_{\nu_e}^2)$为提议分布的协方差矩阵，$\sigma_{n_e}$和$\sigma_{\nu_e}$分别设为参数先验范围的2%和5%。较大的$\nu_e$提议步长考虑了其对时延的低敏感性——需要更大的探索幅度才能有效采样其后验分布。
> 
> 若候选状态$\mathbf{\theta}'$超出先验边界，则直接拒绝该提议并保持当前状态不变；若在先验域内，则计算Metropolis接受概率：
> 
> $$\alpha = \min\left(1, \exp(\ln\mathcal{L}(\mathbf{\theta}') - \ln\mathcal{L}(\mathbf{\theta}^{(t)}))\right) \tag{4-51}$$
> 
> 由于采用均匀先验且提议分布对称，式(4-51)简化为似然比的形式，对数形式的计算有效避免了概率值极小时的数值下溢问题。生成均匀随机数$u \sim U(0,1)$后，若$u < \alpha$则接受候选状态$\mathbf{\theta}^{(t+1)} = \mathbf{\theta}'$，否则拒绝并保持$\mathbf{\theta}^{(t+1)} = \mathbf{\theta}^{(t)}$。这种"概率性接受"机制是MH算法的核心：它允许链以一定概率"上坡"（接受似然较低的状态），从而避免陷入局部极值，实现对后验分布的全局探索。重复上述迭代共$N_{samples} = 10000$次，即可生成完整的马尔可夫链$\{\mathbf{\theta}^{(t)}\}_{t=1}^{N_{samples}}$。

### 改写要点

1. **消除列表标记**：删除"步骤1/2/3/4/5/6"的编号和加粗标题
2. **段落融合**：将6个独立步骤融合为3个连贯段落（初始化→提议与判断→接受机制）
3. **逻辑连接**：使用"随后"、"若...则..."、"生成...后"等连接词串联
4. **公式编号调整**：原4-52、4-53改为4-50、4-51（因前文公式精简）
5. **信息密度提升**：将分散的信息（如提议步长2%/5%）整合到公式解释中

---

## 修改建议总结

- [x] 将4.3.2节"步骤1-6"改为流体感段落
- [x] 将4.3.3节"第一步-第四步"改为流体感段落
- [x] 增加图4-7（迹线图）和图4-8（Corner Plot）的具体描述
- [x] 精简4.3.1节理论时延模型公式（4个→2个）
- [x] 术语微调："极为深刻"→"表明"
- [x] 小结部分去除加粗标题的列表感
- [x] 公式重新编号（4-42至4-52）

---

## 修改后版本

已输出至：`output/第4章_4.3_基于Metropolis-Hastings的贝叶斯参数反演模型_v2.md`
